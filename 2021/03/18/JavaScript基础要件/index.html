<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>JavaScript基础要件 | Apin | blogs</title>

  
  <meta name="author" content="a-pin">
  

  
  <meta name="description" content="This is a blog website in order to record my study experiences!">
  

  
  <meta name="keywords" content="blog,a-pin">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="JavaScript基础要件"/>

  <meta property="og:site_name" content="Apin"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Apin" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  
  <link href="https://fonts.lug.ustc.edu.cn/css?family=Lato|Rubik" rel="stylesheet">
  <script src="/js/pangu-407.min.js"></script>
<meta name="generator" content="Hexo 6.3.0"></head>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    pangu.autoSpacingPage();
  });
</script>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">Apin</a>
    </h1>
    <p class="site-description">blogs</p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/archives">归档</a></li>
      
        <li><a href="/categories">分类</a></li>
      
        <li><a href="/tags">标签</a></li>
      
        <li><a href="/about">关于</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>JavaScript基础要件</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2021/03/18/JavaScript基础要件/" rel="bookmark">
        <time class="entry-date published" datetime="2021-03-17T18:00:07.000Z">
          2021-03-18
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        

<script type="text/javascript">
    function convertRemToPixels(rem) {    
        return rem * parseFloat(getComputedStyle(document.documentElement).fontSize);
    }
    window.onscroll = function() {
        var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
        if (scrollTop > convertRemToPixels(40)) {
            document.getElementsByClassName('toc-article')[0].style.visibility = 'visible';
        } else {
            document.getElementsByClassName('toc-article')[0].style.visibility = 'hidden';
        }
    }

</script>


<div id="toc" class="toc-article" style="overflow-y: scroll; height: 80%;">
      <div class="toc-content">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5"><span class="toc-text">条件语句</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#if%E8%AF%AD%E5%8F%A5"><span class="toc-text">if语句</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#switch%E8%AF%AD%E5%8F%A5"><span class="toc-text">switch语句</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E5%85%83%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-text">三元运算符</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5"><span class="toc-text">循环语句</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#for%E5%BE%AA%E7%8E%AF"><span class="toc-text">for循环</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#while%E8%AF%AD%E5%8F%A5"><span class="toc-text">while语句</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%80%E5%87%BA%E5%BE%AA%E7%8E%AF%E7%9A%84%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-text">退出循环的关键字</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%87%BD%E6%95%B0"><span class="toc-text">函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0"><span class="toc-text">浏览器内置函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E4%B8%8E%E6%96%B9%E6%B3%95"><span class="toc-text">函数与方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0"><span class="toc-text">自定义函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-text">调用函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8C%BF%E5%90%8D%E5%87%BD%E6%95%B0"><span class="toc-text">匿名函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0"><span class="toc-text">函数参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E5%86%B2%E7%AA%81"><span class="toc-text">函数作用域和冲突</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="toc-text">函数返回值</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E4%BB%8B%E7%BB%8D"><span class="toc-text">事件介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E5%99%A8"><span class="toc-text">添加事件处理器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E5%99%A8%E5%B1%9E%E6%80%A7"><span class="toc-text">事件处理器属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%8C%E5%86%85%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E5%99%A8"><span class="toc-text">行内事件处理器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#addEventListener-%E5%92%8CremoveEventListener"><span class="toc-text">addEventListener()和removeEventListener()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%9C%BA%E5%88%B6%E7%AD%96%E7%95%A5"><span class="toc-text">使用机制策略</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E5%AE%83%E4%BA%8B%E4%BB%B6%E6%A6%82%E5%BF%B5"><span class="toc-text">其它事件概念</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1"><span class="toc-text">事件对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%BB%E6%AD%A2%E9%BB%98%E8%AE%A4%E8%A1%8C%E4%B8%BA"><span class="toc-text">阻止默认行为</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E5%86%92%E6%B3%A1%E5%8F%8A%E8%8E%B7%E5%8F%96"><span class="toc-text">事件冒泡及获取</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%B9%E4%BA%8B%E4%BB%B6%E5%86%92%E6%B3%A1%E5%92%8C%E6%8D%95%E6%8D%89%E7%9A%84%E8%A7%A3%E9%87%8A"><span class="toc-text">对事件冒泡和捕捉的解释</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8-stopPropagation-%E4%BF%AE%E5%A4%8D%E9%97%AE%E9%A2%98"><span class="toc-text">用 stopPropagation()修复问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E5%A7%94%E6%89%98"><span class="toc-text">事件委托</span></a></li></ol></li></ol></li></ol></li></ol>
      </div>
</div>
<style>
        .toc-level-3 i,
        .toc-level-3 ol {
            display: none !important;
        }
    </style>



        <p>在此特地声明本文是根据 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Learn/html/Introduction_to_html">mozilla官方教学文档</a> 学习的个人学习笔记，借用了大量的图片和文本内容，存在相当多的相同，但不是copy。如需查看mozilla官方文档，请点击前文链接！！</p>
<!--more-->

<br>

<h1 id="条件语句"><a href="#条件语句" class="headerlink" title="条件语句"></a>条件语句</h1><p>在任何的编程语言中，代码需要依靠不同的输入作为决定并且采取行动。</p>
<br>

<h2 id="if语句"><a href="#if语句" class="headerlink" title="if语句"></a>if语句</h2><p>if语句是基本的条件语句，许多编程语言都有着一样或者相似的语法。</p>
<p>以下是简单的if语句：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> shoppingDone = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (shoppingDone === <span class="literal">true</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> childsAllowance = <span class="number">10</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> childsAllowance = <span class="number">5</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以上只有两个判断条件，两个以上或更复杂的分支可以使用以下两种结构：</p>
<ul>
<li>else if 语句</li>
<li>嵌套if…else</li>
</ul>
<br>

<p><strong>else if 语句</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> choice = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (choice === <span class="number">1</span>) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (choice === <span class="number">2</span>) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    para.<span class="property">textContent</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<p><strong>嵌套if…else</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (choice === <span class="string">&#x27;sunny&#x27;</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (temperature &lt; <span class="number">86</span>) &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (temperature &gt;= <span class="number">86</span>) &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>将一个 if…else 语句放在另一个中，进行嵌套是符合语法的。</p>
<br>

<p>对于条件语句来说，准确描述条件是关键，以下是常用的：</p>
<ul>
<li><strong>比较运算符</strong> 用来判断条件语句中的条件。<ul>
<li><code>===</code> 和 <code>!==</code> 判断一个值是否严格等于或不等于。</li>
<li><code>&lt;</code> 和 <code>&gt;</code> 判断一个值是否小于或大于。</li>
<li><code>&lt;=</code> 和 <code>&gt;=</code> 判断一个值是否小于等于或大于等于。<br>任何不是 false, undefined, null, 0, NaN 的值，或一个空字符串（’’）在作为条件语句进行测试时实际返回true。</li>
</ul>
</li>
<li><strong>逻辑运算符</strong>，如果是要测试多个条件，逻辑运算符是很好的选择。<ul>
<li><code>&amp;&amp;</code> 逻辑与，当每个表达式都返回 true 时，整个表达式才会返回 true。</li>
<li><code>||</code> 逻辑或，当存在任何一个表达式返回 true 时，整个表达式就返回 true。</li>
<li><code>!</code> 逻辑非，对一个布尔值取反。</li>
</ul>
</li>
</ul>
<br>

<h2 id="switch语句"><a href="#switch语句" class="headerlink" title="switch语句"></a>switch语句</h2><p>if…else 语句主要适用于您只有几个选择的情况，每个都需要相当数量的代码来运行，和&#x2F;或 的条件很复杂的情况（例如多个逻辑运算符）。</p>
<p>对于只想将变量设置一系列为特定值的选项或根据条件打印特定语句的情况，语法可能会很麻烦，特别是如果您有大量选择。</p>
<p>switch 语句以单个表达式或值作为输入，然后查看多个选项，直到找到与该值相匹配的选项，执行与之相关的代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (expression) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="attr">choice1</span>:</span><br><span class="line">    run <span class="variable language_">this</span> code</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">case</span> <span class="attr">choice2</span>:</span><br><span class="line">    run <span class="variable language_">this</span> code instead</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// include as many cases as you like</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">default</span>:</span><br><span class="line">    actually, just run <span class="variable language_">this</span> code</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<h2 id="三元运算符"><a href="#三元运算符" class="headerlink" title="三元运算符"></a>三元运算符</h2><p>三元运算符 用于测试一个条件，如果返回 ture 运行前面的代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">( condition ) ? run <span class="variable language_">this</span> code : run <span class="variable language_">this</span> code instead</span><br></pre></td></tr></table></figure>

<br>

<h1 id="循环语句"><a href="#循环语句" class="headerlink" title="循环语句"></a>循环语句</h1><p>编程语言可以依靠循环结构迅速方便地完成一些重复性的任务。</p>
<br>

<h2 id="for循环"><a href="#for循环" class="headerlink" title="for循环"></a>for循环</h2><p>以下是 for 循环的语法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (initializer; exit-condition; final-expression) &#123;</span><br><span class="line">  <span class="comment">// code to run</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>你需要斟酌括号内的内容，防止出现死循环。</p>
<ol>
<li>关键字for</li>
<li>括号内的三个项目，以分号分隔：<ul>
<li><strong>初始化器</strong>：这通常是一个设置为一个数字的变量，它被递增来计算循环运行的次数</li>
<li><strong>退出条件</strong>：定义循环何时停止循环，通常是一个表现为比较运算符的表达式，用于查看退出条件是否已满足的测试</li>
<li><strong>最终条件</strong>：通常用于增加（或在某些情况下递减）计数器变量，使其更接近退出条件值</li>
</ul>
</li>
<li>每次循环迭代时都会运行的代码快</li>
</ol>
<br>

<h2 id="while语句"><a href="#while语句" class="headerlink" title="while语句"></a>while语句</h2><p><strong>while循环的语法结构：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">initializer</span><br><span class="line"><span class="keyword">while</span> (exit-condition) &#123;</span><br><span class="line">  <span class="comment">// code to run</span></span><br><span class="line"></span><br><span class="line">  final-expression</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>do…while循环的语法结构：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">initializer</span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">  <span class="comment">// code to run</span></span><br><span class="line"></span><br><span class="line">  final-expression</span><br><span class="line">&#125; <span class="keyword">while</span> (exit-condition)</span><br></pre></td></tr></table></figure>

<p>相对于 while 循环，do…while 循环无论如何都会执行代码块一次。因为它的退出条件是在代码块之后。</p>
<br>

<h2 id="退出循环的关键字"><a href="#退出循环的关键字" class="headerlink" title="退出循环的关键字"></a>退出循环的关键字</h2><p><strong>使用 break 退出循环：</strong></p>
<p>如果要在所有迭代完成之前退出循环，使用 break 语句立即退出循环。</p>
<p><strong>使用 continue 跳出迭代：</strong></p>
<p>continue语句以类似的方式工作，而不是完全跳出循环，而是跳过当前循环而执行下一个循环。</p>
<br>

<h1 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h1><p>函数允许你在一个代码块中存储一段用于处理单任务的代码，然后在任何你需要的时候用一个简短的命令来调用。</p>
<br>

<h2 id="浏览器内置函数"><a href="#浏览器内置函数" class="headerlink" title="浏览器内置函数"></a>浏览器内置函数</h2><p>浏览器中有许多可使用的内置函数，例如字符串的 replace、数组的 join 和 生成随机数的 Math.random()。</p>
<p>JavaScript 内置的函数可以让您做很多有用的事情，而无需自己编写所有的代码。事实上，许多你调用浏览器内置函数时调用的代码并不是使用 JavaScript 来编写——大多数是使用像 C++ 这样更低级的系统语言编写的。</p>
<blockquote>
<p>注：这些内置浏览器函数不是核心 JavaScript 语言的一部分，而是被定义为浏览器 API 的一部分。</p>
</blockquote>
<br>

<h2 id="函数与方法"><a href="#函数与方法" class="headerlink" title="函数与方法"></a>函数与方法</h2><p>程序员把函数称为对象<strong>方法（method）</strong>的一部分。严格说来，内置浏览器函数并不是函数——它们是方法。</p>
<p>二者区别在于方法是在对象内定义的函数。浏览器内置函数（方法）和变量（称为属性）存储在结构化对象内，以使代码更加高效，易于处理。</p>
<p>到目前为止我们所使用的内置代码同属于这两种形式：函数和方法。你可以在<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects">这里</a>查看内置函数，内置对象以及其相关方法的完整列表。</p>
<br>

<h2 id="自定义函数"><a href="#自定义函数" class="headerlink" title="自定义函数"></a>自定义函数</h2><p>在之前的代码中我们自己定义了许多特定的功能，而不是在浏览器中。每当您看到一个自定义名称后面都带有括号，那么您使用的是自定义函数。例如 draw() 函数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">draw</span>(<span class="params"></span>) &#123;</span><br><span class="line">  ctx.<span class="title function_">clearRect</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="variable constant_">WIDTH</span>,<span class="variable constant_">HEIGHT</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">    ctx.<span class="title function_">beginPath</span>();</span><br><span class="line">    ctx.<span class="property">fillStyle</span> = <span class="string">&#x27;rgba(255,0,0,0.5)&#x27;</span>;</span><br><span class="line">    ctx.<span class="title function_">arc</span>(<span class="title function_">random</span>(<span class="variable constant_">WIDTH</span>), <span class="title function_">random</span>(<span class="variable constant_">HEIGHT</span>), <span class="title function_">random</span>(<span class="number">50</span>), <span class="number">0</span>, <span class="number">2</span> * <span class="title class_">Math</span>.<span class="property">PI</span>);</span><br><span class="line">    ctx.<span class="title function_">fill</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个函数将在 <code>&lt;canvas&gt;</code> 元素中绘制100个随机圆。我们可以在需要的时候调用这个函数。</p>
<blockquote>
<p>注：对于函数名约定，应遵循与变量名约定相同的规则。</p>
</blockquote>
<br>

<h2 id="调用函数"><a href="#调用函数" class="headerlink" title="调用函数"></a>调用函数</h2><p>在函数定义后使用它，你必须调用它，这通常通过函数名后跟圆括号实现的。例如，调用前文的 draw 函数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">draw</span>();</span><br></pre></td></tr></table></figure>

<p>在函数中可以包含任何需要的代码，包括在函数中调用其它函数。</p>
<p>对于调用函数，你需要知道——在函数名后面的这个括号叫做 <strong>函数调用运算符</strong>（function invocation operator）。你只有在想直接调用函数的地方才这么写：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//first</span></span><br><span class="line">btn.<span class="property">onclick</span> = draw;</span><br><span class="line"></span><br><span class="line"><span class="comment">//second</span></span><br><span class="line">btn.<span class="property">onclick</span> = <span class="title function_">draw</span>();</span><br></pre></td></tr></table></figure>

<p>在第一个事件处理中，只有点击按钮才会调用函数；在第二个事件处理中，无论是否点击按钮都会运行一次函数，而之后点击按钮也无法运行函数。</p>
<br>

<h2 id="匿名函数"><a href="#匿名函数" class="headerlink" title="匿名函数"></a>匿名函数</h2><p>创建一个没有名称的函数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">&#x27;hello&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样的函数叫做<strong>匿名函数</strong>。它没有函数名也不会自己做任何事情。通常将匿名函数与事件处理程序一起使用，即<strong>使用匿名函数来运行负载的代码以响应事件触发</strong>——使用事件处理程序。例如，如果单击按钮，以下操作将在函数内运行代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myButton = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;button&#x27;</span>);</span><br><span class="line"></span><br><span class="line">myButton.<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">&#x27;hello&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个示例可以在你点击按钮后打印出 hello 的字符串。</p>
<p>你可以将匿名函数分配为变量的值，例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myGreeting = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">&#x27;hello&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>类似使用函数名调用函数，你调用匿名函数可以：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">myGreeting</span>();</span><br></pre></td></tr></table></figure>

<p>不过这中做法是没必要的，而且会造成混淆。</p>
<blockquote>
<p>注：匿名函数也称为函数表达式。函数表达式与函数声明有一些区别。函数声明会进行声明提升（declaration hoisting），而函数表达式不会。</p>
</blockquote>
<br>

<h2 id="函数参数"><a href="#函数参数" class="headerlink" title="函数参数"></a>函数参数</h2><p>一些函数需要在调用时指定参数，这些参数值放在函数括号内。</p>
<p>例如，浏览器内置的 Math.random() 函数不需要任何参数，而内置字符串 replace() 函数需要两个参数：查找的字符串和替换的字符串。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> num = <span class="title class_">Math</span>.<span class="title function_">random</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> myText = <span class="string">&#x27;I am a string&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> newString = myText.<span class="title function_">replace</span>(<span class="string">&#x27;string&#x27;</span>, <span class="string">&#x27;sausage&#x27;</span>);</span><br></pre></td></tr></table></figure>

<br>

<h2 id="函数作用域和冲突"><a href="#函数作用域和冲突" class="headerlink" title="函数作用域和冲突"></a>函数作用域和冲突</h2><p>当你创建一个函数时，函数内定义的变量和其他东西都被锁在自己独立的隔间中, 不能被函数外的代码访问。所有函数的最外层被称为<strong>全局作用域</strong>，在全局作用域内定义的值可以在任意地方访问。</p>
<p>有时您不希望变量可以在代码中的任何地方访问 - 您从其他地方调用的外部脚本可能会开始搞乱您的代码并导致问题，因为它们恰好与代码的其他部分使用了相同的变量名称，造成冲突。这可能是恶意的，或者是偶然的。</p>
<p>例如，假设您有一个HTML文件，它调用两个外部JavaScript文件，并且它们都有一个使用相同名称定义的变量和函数：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Excerpt from my HTML --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;first.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;second.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">  greeting();</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// first.js</span></span><br><span class="line"><span class="keyword">let</span> name = <span class="string">&#x27;Chris&#x27;</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">greeting</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">&#x27;Hello &#x27;</span> + name + <span class="string">&#x27;: welcome to our company.&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// second.js</span></span><br><span class="line"><span class="keyword">let</span> name = <span class="string">&#x27;Zaptec&#x27;</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">greeting</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">&#x27;Our company is called &#x27;</span> + name + <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这两个函数都使用 greeting() 形式调用，但是你只能访问到 first.js 文件的greeting()函数（第二个文件被忽视了）。另外，第二次尝试使用 let 关键字定义 name 变量导致了一个错误。</p>
<p>明显，在函数中声明变量可以避免这种问题。</p>
<br>

<h2 id="函数返回值"><a href="#函数返回值" class="headerlink" title="函数返回值"></a>函数返回值</h2><p>返回值指的是函数执行完毕后返回的值，你需要使用 <code>return</code> 关键字。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">randomNumber</span>(<span class="params">number</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>()*number);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>每次调用函数都返回 <code>Math.floor(Math.random()*number)</code> 计算的数学结果。这个返回值出现在调用函数的位置上，并且代码继续。</p>
<br>

<h1 id="事件介绍"><a href="#事件介绍" class="headerlink" title="事件介绍"></a>事件介绍</h1><p>事件是在编程时系统内发生的动作或者发生的事情；系统响应事件后，如果需要，能以某种方式对事件做出回应。系统会在事件出现时产生或触发某种信号，并提供一个自动加载某种动作的机制。</p>
<p>每个可用的事件都会有一个<strong>事件处理器（事件监听器）</strong>，也就是事件触发时会运行的代码块。</p>
<br>

<h2 id="添加事件处理器"><a href="#添加事件处理器" class="headerlink" title="添加事件处理器"></a>添加事件处理器</h2><p>有许多方法可以将事件监听器添加到网页，以便在关联的事件触发时运行它。</p>
<br>

<h3 id="事件处理器属性"><a href="#事件处理器属性" class="headerlink" title="事件处理器属性"></a>事件处理器属性</h3><p>这是一个不断变换背景颜色的例子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> btn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;button&#x27;</span>);</span><br><span class="line"></span><br><span class="line">btn.<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> rndCol = <span class="string">&#x27;rgb(&#x27;</span> + <span class="title function_">random</span>(<span class="number">255</span>) + <span class="string">&#x27;,&#x27;</span> + <span class="title function_">random</span>(<span class="number">255</span>) + <span class="string">&#x27;,&#x27;</span> + <span class="title function_">random</span>(<span class="number">255</span>) + <span class="string">&#x27;)&#x27;</span>;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">backgroundColor</span> = rndCol;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个 <code>onclick</code> 是被用在这个情景下的事件处理器的属性，类似 <code>btn.textContent</code> 和 <code>btn.style</code>。</p>
<p>你也可以将一个有名字的函数赋给事件处理函数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> btn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;button&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">bgChange</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> rndCol = <span class="string">&#x27;rgb(&#x27;</span> + <span class="title function_">random</span>(<span class="number">255</span>) + <span class="string">&#x27;,&#x27;</span> + <span class="title function_">random</span>(<span class="number">255</span>) + <span class="string">&#x27;,&#x27;</span> + <span class="title function_">random</span>(<span class="number">255</span>) + <span class="string">&#x27;)&#x27;</span>;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">backgroundColor</span> = rndCol;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">btn.<span class="property">onclick</span> = bgChange;</span><br></pre></td></tr></table></figure>

<p>还有很多事件处理参数可以选择：</p>
<ul>
<li><code>btn.onfocus</code> 和 <code>btn.onblur</code> ：按钮被置于焦点或解除焦点。</li>
<li><code>btn.ondblclick</code> ：按钮被双击。</li>
<li><code>btn.onmouseover</code> 和 <code>btn.onmouseout</code> ：在鼠标移入按钮上方, 或者当从按钮移出时.</li>
</ul>
<br>

<h3 id="行内事件处理器"><a href="#行内事件处理器" class="headerlink" title="行内事件处理器"></a>行内事件处理器</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;bgChange()&quot;</span>&gt;</span>Press me<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">bgChange</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> rndCol = <span class="string">&#x27;rgb(&#x27;</span> + <span class="title function_">random</span>(<span class="number">255</span>) + <span class="string">&#x27;,&#x27;</span> + <span class="title function_">random</span>(<span class="number">255</span>) + <span class="string">&#x27;,&#x27;</span> + <span class="title function_">random</span>(<span class="number">255</span>) + <span class="string">&#x27;)&#x27;</span>;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">backgroudColor</span> = rndCol;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在 Web 上注册事件处理器的最早方法是类似于上面所示的<strong>事件处理程序HTML属性</strong>（也称为内联事件处理程序），属性值实际上是当事件发生时要运行的 Javascript 代码。</p>
<p>直接在属性内插入 JavaScript ，例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;button onclick=<span class="string">&quot;alert(&#x27;Hello, this is my old-fashioned event handler!&#x27;);&quot;</span>&gt;<span class="title class_">Press</span> me&lt;/button&gt;</span><br></pre></td></tr></table></figure>

<p>你会发现，这样 HTML 属性等价于对事件处理程序的属性。这被认为是不好的做法，既会使代码混淆不可读，变得难以管理和效率低下。</p>
<p>不要混用 HTML 和 JavaScript ，这样会使文档很难解析。你应该在只在一块地方写 JavaScript 代码。</p>
<br>

<h3 id="addEventListener-和removeEventListener"><a href="#addEventListener-和removeEventListener" class="headerlink" title="addEventListener()和removeEventListener()"></a>addEventListener()和removeEventListener()</h3><p>新的事件触发机制被定义在 <a target="_blank" rel="noopener" href="https://www.w3.org/TR/DOM-Level-2-Events/">Document Object Model (DOM) Level 2 Events</a> Specification, 这个细则给浏览器提供了一个函数—— <code>addEventListener()</code>。</p>
<p>重写上面的随机颜色背景代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> btn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;button&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">bgChange</span>(<span class="params"></span>) &#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">btn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, bgChange);</span><br></pre></td></tr></table></figure>

<p>在 addEventListener() 函数中, 我们具体化了两个参数——我们想要将处理器应用上去的事件名称，和包含我们用来回应事件的函数的代码。注意将这些代码全部放到一个匿名函数中是可行的:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">btn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> rndCol = <span class="string">&#x27;rgb(&#x27;</span> + <span class="title function_">random</span>(<span class="number">255</span>) + <span class="string">&#x27;,&#x27;</span> + <span class="title function_">random</span>(<span class="number">255</span>) + <span class="string">&#x27;,&#x27;</span> + <span class="title function_">random</span>(<span class="number">255</span>) + <span class="string">&#x27;)&#x27;</span>;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">backgroundColor</span> = rndCol;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>这个机制带来了一些相较于旧方式的优点。有一个相对应的方法用于<strong>移除</strong>事件监听器 <code>removeEventListener()</code>，这个方法。例如，下面的代码将会移除上个代码块中的事件监听器：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">btn.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;click&#x27;</span>, bgChange);</span><br></pre></td></tr></table></figure>

<p>在这个简单的、小型的项目中可能不是很有用，但是在大型的、复杂的项目中就非常有用了，可以非常高效地清除不用的事件处理器，另外在其他的一些场景中也非常有效——比如您需要在不同环境下运行不同的事件处理器，您只需要恰当地删除或者添加事件处理器即可。</p>
<p>你也可以给同一个监听器注册多个处理器：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">myElement.<span class="property">onclick</span> = functionA;</span><br><span class="line">myElement.<span class="property">onclick</span> = functionB;</span><br><span class="line"></span><br><span class="line"><span class="comment">//第二行会覆盖第一行，但是下面这种方式就会正常工作了：</span></span><br><span class="line"></span><br><span class="line">myElement.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, functionA);</span><br><span class="line">myElement.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, functionB);</span><br><span class="line"></span><br><span class="line"><span class="comment">//当元素被点击时两个函数都会工作：</span></span><br></pre></td></tr></table></figure>

<p>此外，该事件机制还提供了许多其他强大的特性和选项。如果您想要阅读它们，可以查看 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener">addEventListener()</a> 和 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/removeEventListener">removeEventListener()</a> 。</p>
<br>

<h3 id="使用机制策略"><a href="#使用机制策略" class="headerlink" title="使用机制策略"></a>使用机制策略</h3><p>在三种机制中,您<strong>绝对不应该</strong>使用<strong>HTML事件处理程序属性</strong>，这些属性已经过时了，而且也是不好的做法。</p>
<p>另外两种是相对可互换的，至少对于简单的用途:</p>
<ul>
<li><strong>事件处理程序属性</strong>功能和选项会更少，但是具有更好的跨浏览器兼容性(在Internet Explorer 8的支持下)。</li>
<li><strong>DOM Level 2 Events</strong>（addEventListener(), etc.）更强大，但也可以变得更加复杂，并且支持不足（只支持到Internet Explorer 9）。</li>
</ul>
<p><strong>DOM Level 2 Events</strong>（addEventListener(), etc.）的主要优点是</p>
<ul>
<li>可以使用 removeEventListener() 删除事件处理程序代码</li>
<li>可以向同一类型的元素添加多个监听器（对于<strong>事件处理程序属性</strong>，后面任何设置的属性都会尝试覆盖较早的属性）</li>
</ul>
<blockquote>
<p>注：如果你在工作中被要求支持比 Internet Explorer 8 更老的浏览器，你可能会遇到困难，因为这些古老的浏览器会使用与现代浏览器不同的<strong>事件处理模型</strong>。不过大多数 JavaScript 库（例如 jQuery ）都内置了能够跨浏览器差异的函数。</p>
</blockquote>
<br>

<h2 id="其它事件概念"><a href="#其它事件概念" class="headerlink" title="其它事件概念"></a>其它事件概念</h2><p>这里将简要介绍一些与事件相关的高级概念，并不需要完全理解透彻，但它可能有助于你解释一些经常会遇到的代码模式。</p>
<br>

<h3 id="事件对象"><a href="#事件对象" class="headerlink" title="事件对象"></a>事件对象</h3><p>有时候在事件处理函数内部，你可能会看到一个固定指定名称的参数，例如 event，evt或 e。这被称为<strong>事件对象</strong>，它被自动传递给事件处理函数，以提供额外的功能和信息。 例如，让我们稍稍重写一遍我们的随机颜色示例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">bgChange</span>(<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> rndCol = <span class="string">&#x27;rgb(&#x27;</span> + <span class="title function_">random</span>(<span class="number">255</span>) + <span class="string">&#x27;,&#x27;</span> + <span class="title function_">random</span>(<span class="number">255</span>) + <span class="string">&#x27;,&#x27;</span> + <span class="title function_">random</span>(<span class="number">255</span>) + <span class="string">&#x27;)&#x27;</span>;</span><br><span class="line">  e.<span class="property">target</span>.<span class="property">style</span>.<span class="property">backgroundColor</span> = rndCol;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(e);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">btn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, bgChange);</span><br></pre></td></tr></table></figure>

<p>在这里，你可以看到我们在函数中包括一个事件对象 e，并在函数中设置背景颜色样式在 e.target 上（它指的是按钮本身）。事件对象 e 的 target 属性始终是<strong>事件刚刚发生的元素的引用</strong>。 所以在这个例子中，我们在按钮上设置一个随机的背景颜色，而不是页面。</p>
<p>当你要在多个元素上设置相同的事件处理程序时，e.target 非常有用。例如，你可能有一组方格，当它们被点击时就会消失。用 e.target 总是能准确选择当前操作的东西并执行操作让它消失，而不是必须以更困难的方式选择它。</p>
<p><a target="_blank" rel="noopener" href="https://a-pin.github.io/demo/divcolor/color">点击这里</a>，我们创建了16个 div 元素，使用 document.querySelectorAll() 选择全部的元素,然后遍历每一个，为每一个元素都添加一个onclick单击事件，每当它们点击时就会为背景添加一个随机颜色。</p>
<p>你遇到的大多数事件处理器的事件对象都有可用的标准属性和函数（方法）。然而，一些更高级的处理程序会添加一些专业属性，这些属性包含它们需要运行的额外数据。</p>
<br>

<h3 id="阻止默认行为"><a href="#阻止默认行为" class="headerlink" title="阻止默认行为"></a>阻止默认行为</h3><p>有时，你会遇到一些情况，你希望事件不执行它的默认行为。例如自定义注册表单，当你填写详细信息并按提交按钮时，自然行为是将数据提交到服务器上的指定页面进行处理，并将浏览器重定向到某种“成功消息”页面（或 相同的页面，如果另一个没有指定。）</p>
<p>当用户没有正确提交数据时，麻烦就来了。作为开发人员，你希望停止提交信息给服务器，并给他们一个错误提示，告诉他们什么做错了，以及需要做些什么来修正错误。一些浏览器支持自动的表单数据验证功能，但由于许多浏览器不支持，因此建议你不要依赖这些功能，并实现自己的验证检查。 我们来看一个简单的例子。</p>
<p>首先，一个简单的HTML表单，需要你填入名（first name）和姓（last name）</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;fname&quot;</span>&gt;</span>First name: <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;fname&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;lname&quot;</span>&gt;</span>Last name: <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;lname&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里我们用一个 onsubmit 事件处理程序（在提交的时候，在一个表单上发起submit事件）来实现一个非常简单的检查，用于测试文本字段是否为空。如果是，我们在事件对象上调用 preventDefault() 函数，这样就停止了表单提交，然后在我们表单下面的段落中显示一条错误消息，告诉用户什么是错误的：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> form = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;form&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fname = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;fname&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> lname = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;lname&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> submit = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;submit&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> para = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;p&#x27;</span>);</span><br><span class="line"></span><br><span class="line">form.<span class="property">onsubmit</span> = <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (fname.<span class="property">value</span> === <span class="string">&#x27;&#x27;</span> || lname.<span class="property">value</span> === <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">    e.<span class="title function_">preventDefault</span>();</span><br><span class="line">    para.<span class="property">textContent</span> = <span class="string">&#x27;You need to fill in both names!&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<h3 id="事件冒泡及获取"><a href="#事件冒泡及获取" class="headerlink" title="事件冒泡及获取"></a>事件冒泡及获取</h3><p>最后即将介绍的这个主题常常不会深究，但如果你不理解这个主题，就会十分痛苦。事件冒泡和捕捉是两种机制，主要描述当在一个元素上有两个相同类型的事件处理器被激活会发生什么。</p>
<p>这是一个非常简单的例子，它显示和隐藏一个包含 video 元素的 div 元素：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span>&gt;</span>Display video<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;hidden&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">video</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">source</span> <span class="attr">src</span>=<span class="string">&quot;rabbit320.mp4&quot;</span> <span class="attr">type</span>=<span class="string">&quot;video/mp4&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">source</span> <span class="attr">src</span>=<span class="string">&quot;rabbit320.webm&quot;</span> <span class="attr">type</span>=<span class="string">&quot;video/webm&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Your browser doesn&#x27;t support HTML5 video. Here is a <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;rabbit320.mp4&quot;</span>&gt;</span>link to the video<span class="tag">&lt;/<span class="name">a</span>&gt;</span> instead.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>当 button 元素按钮被单击时，将显示视频，它是通过将改变  div 的 class 属性值从hidden 变为 showing（这个例子的 CSS 包含两个 class，它们分别控制这个 div 盒子在屏幕上显示还是隐藏)：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">btn.<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  videoBox.<span class="title function_">setAttribute</span>(<span class="string">&#x27;class&#x27;</span>, <span class="string">&#x27;showing&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后我们再添加几个 onclick 事件处理器，第一个添加在 div 元素上，第二个添加在 video 元素上。这个想法是当视频（video）外 div 元素内这块区域被单击时，这个视频盒子应该再次隐藏；当单击视频（video）本身，这个视频将开始播放。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">videoBox.<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  videoBox.<span class="title function_">setAttribute</span>(<span class="string">&#x27;class&#x27;</span>, <span class="string">&#x27;hidden&#x27;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">video.<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  video.<span class="title function_">play</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>但是有一个问题——当您点击 video 开始播放的视频时，它会在同一时间导致 div 也被隐藏。这是因为 video 是 div 的一个子元素，所以点击 video 实际上是同时也会运行 div 上的事件处理程序。</p>
<br>

<h4 id="对事件冒泡和捕捉的解释"><a href="#对事件冒泡和捕捉的解释" class="headerlink" title="对事件冒泡和捕捉的解释"></a>对事件冒泡和捕捉的解释</h4><p>当一个事件发生在具有父元素的元素上（例如，在我们的例子中是 video 元素）时，现代浏览器运行两个不同的机制：捕获机制和冒泡机制。在捕获机制：</p>
<ul>
<li>浏览器检查元素的最外层祖先 <code>&lt;html&gt;</code>，是否在捕获阶段中注册了一个 onclick 事件处理程序，如果是，则运行它。</li>
<li>然后，它移动到 <code>&lt;html&gt;</code> 中单击元素的下一个祖先元素，并执行相同的操作，然后是单击元素再下一个祖先元素，依此类推，直到到达实际点击的元素。</li>
</ul>
<p>在冒泡机制，恰恰相反：</p>
<ul>
<li>浏览器检查实际点击的元素是否在冒泡阶段中注册了一个 onclick 事件处理程序，如果是，则运行它。</li>
<li>然后它移动到下一个直接的祖先元素，并做同样的事情，然后是下一个，等等，直到它到达 <code>&lt;html&gt;</code> 元素。</li>
</ul>
<p><img src="/2021/03/18/JavaScript%E5%9F%BA%E7%A1%80%E8%A6%81%E4%BB%B6/1.png" alt="bubbling-capturing"></p>
<p>在现代浏览器中，默认情况下，所有事件处理程序都在<strong>冒泡机制</strong>进行注册。因此，在我们当前的示例中，当您单击视频时，这个单击事件从 <code>&lt;video&gt;</code> 元素向外冒泡直到 <code>&lt;html&gt;</code> 元素。沿着这个事件冒泡线路：</p>
<ul>
<li>它发现了 video.onclick…事件处理器 并且运行它，因此这个视频 <code>&lt;video&gt;</code> 第一次开始播放。</li>
<li>接着它发现了（往外冒泡找到的）videoBox.onclick…事件处理器 并且运行它，因此这个视频 <code>&lt;video&gt;</code> 也隐藏起来了。</li>
</ul>
<br>

<h4 id="用-stopPropagation-修复问题"><a href="#用-stopPropagation-修复问题" class="headerlink" title="用 stopPropagation()修复问题"></a>用 stopPropagation()修复问题</h4><p>我们可以使用一个标准事件对象具有可用的名为 <code>stopPropagation()</code> 的函数, 当在事件对象上调用该函数时，它只会让当前事件处理程序运行，但事件不会在冒泡链上进一步扩大，因此将不会有更多事件处理器被运行（不会向上冒泡）。所以，我们可以通过改变前面代码块中的第二个处理函数来解决当前的问题：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">video.<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">  e.<span class="title function_">stopPropagation</span>();</span><br><span class="line">  video.<span class="title function_">play</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注：在过去，浏览器的兼容性比现在要小得多，Netscape 只使用事件捕获，而 Internet Explorer 只使用事件冒泡。当 W3C 决定尝试规范这些行为并达成共识时，最终得到了包括 捕捉和冒泡 的系统，最终被应用在现在浏览器里。</p>
</blockquote>
<blockquote>
<p>注：默认情况下，所有事件处理程序都是在冒泡机制注册的，这在大多数情况下更有意义。如果您真的想在捕获阶段注册一个事件，那么您可以通过使用 addEventListener() 注册您的处理程序，并将可选的<strong>第三个参数</strong>设置为 true。</p>
</blockquote>
<br>

<h4 id="事件委托"><a href="#事件委托" class="headerlink" title="事件委托"></a>事件委托</h4><p>冒泡还允许我们利用<strong>事件委托</strong>，这个概念依赖于这样一个事实：如果你想要在大量子元素中单击任何一个都可以运行一段代码，你可以将事件监听器设置在其父节点上，并让子节点上发生的事件冒泡到父节点上，而不是每个子节点单独设置事件监听器。</p>
<p>一个很好的例子是一系列列表项，如果你想让每个列表项被点击时弹出一条信息，您可以将 click 单击事件监听器设置在父元素 <code>&lt;ul&gt;</code> 上，这样事件就会从列表项冒泡到其父元素 <code>&lt;ul&gt;</code> 上。</p>
<p>这个的概念在 David Walsh 的博客上有更多的解释，并有多个例子——看看 <a target="_blank" rel="noopener" href="https://davidwalsh.name/event-delegate">How JavaScript Event Delegation Works</a>。</p>
<br>

<br>

<blockquote>
<p><strong>总结：</strong></p>
<p><strong>事件并不是JavaScript的核心部分——它们是在浏览器 Web APIs 中定义的。</strong></p>
<p>另外，理解 JavaScript 在不同环境下使用不同的事件模型很重要——从 Web api 到其他领域，如浏览器 WebExtensions 和 Node.js（服务器端 JavaScript）。当你在学习 web 开发的过程中，理解这些事件的基础是很有帮助的。</p>
</blockquote>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/web前端/">web前端</a>, <a href="/categories/web前端/mdn/">mdn</a>, <a href="/categories/web前端/mdn/JavaScript/">JavaScript</a>
    </span>
    

    

    </div>

    
  </div>
</article>

  






    </main>

    <footer class="site-footer">
  <p class="site-info">
    Deployed by <a href="https://github.com/kaedea/notion-down" target="_blank">notion-down</a> and
    Theme by <a href="https://github.com/kaedea/hexo-theme-hacker" target="_blank">hexo-theme-hacker</a>
    </br>
    
    &copy; 2023 a-pin
    
  </p>
</footer>
    
  </div>
</div>
</body>
</html>