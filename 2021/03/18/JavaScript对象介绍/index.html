<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>JavaScript对象介绍 | Apin | blogs</title>

  
  <meta name="author" content="a-pin">
  

  
  <meta name="description" content="This is a blog website in order to record my study experiences!">
  

  
  <meta name="keywords" content="blog,a-pin">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="JavaScript对象介绍"/>

  <meta property="og:site_name" content="Apin"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Apin" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  
  <link href="https://fonts.lug.ustc.edu.cn/css?family=Lato|Rubik" rel="stylesheet">
  <script src="/js/pangu-407.min.js"></script>
<meta name="generator" content="Hexo 6.3.0"></head>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    pangu.autoSpacingPage();
  });
</script>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">Apin</a>
    </h1>
    <p class="site-description">blogs</p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/archives">归档</a></li>
      
        <li><a href="/categories">分类</a></li>
      
        <li><a href="/tags">标签</a></li>
      
        <li><a href="/about">关于</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>JavaScript对象介绍</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2021/03/18/JavaScript对象介绍/" rel="bookmark">
        <time class="entry-date published" datetime="2021-03-17T18:00:07.000Z">
          2021-03-18
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        

<script type="text/javascript">
    function convertRemToPixels(rem) {    
        return rem * parseFloat(getComputedStyle(document.documentElement).fontSize);
    }
    window.onscroll = function() {
        var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
        if (scrollTop > convertRemToPixels(40)) {
            document.getElementsByClassName('toc-article')[0].style.visibility = 'visible';
        } else {
            document.getElementsByClassName('toc-article')[0].style.visibility = 'hidden';
        }
    }
</script>


<div id="toc" class="toc-article">
      <div class="toc-content">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#javascript%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80"><span class="toc-text">javascript对象基础</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80"><span class="toc-text">对象基础</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1"><span class="toc-text">创建对象</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="toc-text">构造函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Object-%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="toc-text">Object()构造函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#create-%E6%96%B9%E6%B3%95"><span class="toc-text">create()方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%AF%B9%E8%B1%A1%E6%88%90%E5%91%98"><span class="toc-text">设置对象成员</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E5%AF%B9%E8%B1%A1"><span class="toc-text">访问对象</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%82%B9%E8%A1%A8%E7%A4%BA%E6%B3%95"><span class="toc-text">点表示法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%AC%E5%8F%B7%E8%A1%A8%E7%A4%BA%E6%B3%95"><span class="toc-text">括号表示法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#this%E7%9A%84%E5%90%AB%E4%B9%89"><span class="toc-text">this的含义</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E5%8E%9F%E5%9E%8B"><span class="toc-text">对象原型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E5%8E%9F%E5%9E%8B%E7%9A%84%E8%AF%AD%E8%A8%80"><span class="toc-text">基于原型的语言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8javascript%E4%B8%AD%E7%9A%84%E5%8E%9F%E5%9E%8B"><span class="toc-text">使用javascript中的原型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#prototype%E5%B1%9E%E6%80%A7"><span class="toc-text">prototype属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#create"><span class="toc-text">create()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#constructor%E5%B1%9E%E6%80%A7"><span class="toc-text">constructor属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%8E%9F%E5%9E%8B"><span class="toc-text">修改原型</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#javascript%E4%B8%AD%E7%9A%84%E7%BB%A7%E6%89%BF"><span class="toc-text">javascript中的继承</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%9F%E5%9E%8B%E5%BC%8F%E7%9A%84%E7%BB%A7%E6%89%BF"><span class="toc-text">原型式的继承</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89Teacher-%E6%9E%84%E9%80%A0%E5%99%A8%E5%87%BD%E6%95%B0"><span class="toc-text">定义Teacher()构造器函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E%E6%97%A0%E5%8F%82%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%BB%A7%E6%89%BF"><span class="toc-text">从无参构造函数继承</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AETeacher-%E7%9A%84%E5%8E%9F%E5%9E%8B%E5%92%8C%E6%9E%84%E9%80%A0%E5%99%A8%E5%BC%95%E7%94%A8"><span class="toc-text">设置Teacher()的原型和构造器引用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E6%88%90%E5%91%98%E6%80%BB%E7%BB%93"><span class="toc-text">对象成员总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ECMAScript-2015-%E7%B1%BB"><span class="toc-text">ECMAScript 2015 类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E7%B1%BB%E8%AF%AD%E6%B3%95%E8%BF%9B%E8%A1%8C%E7%BB%A7%E6%89%BF"><span class="toc-text">使用类语法进行继承</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#getter%E5%92%8Csetter"><span class="toc-text">getter和setter</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%95%E6%97%B6%E5%9C%A8javascript%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%BB%A7%E6%89%BF"><span class="toc-text">何时在javascript中使用继承</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8json"><span class="toc-text">使用json</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFjson"><span class="toc-text">什么是json</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#json%E5%AF%B9%E8%B1%A1"><span class="toc-text">json对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#json%E6%95%B0%E7%BB%84"><span class="toc-text">json数组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-text">其他注意事项</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E4%B8%AAjson%E7%A4%BA%E4%BE%8B"><span class="toc-text">一个json示例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%A7%8B"><span class="toc-text">开始</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BDjson"><span class="toc-text">加载json</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%BD%8Dheader"><span class="toc-text">定位header</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%8B%B1%E9%9B%84%E4%BF%A1%E6%81%AF%E5%8D%A1%E7%89%87"><span class="toc-text">创建英雄信息卡片</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E5%92%8C%E6%96%87%E6%9C%AC%E9%97%B4%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-text">对象和文本间的转换</span></a></li></ol></li></ol>
      </div>
</div>
<style>
        .toc-level-3 i,
        .toc-level-3 ol {
            display: none !important;
        }
    </style>



        <p>在此特地声明本文是根据 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Learn/html/Introduction_to_html">mozilla官方教学文档</a> 学习的个人学习笔记，借用了大量的图片和文本内容，存在相当多的相同，但不是copy。如需查看mozilla官方文档，请点击前文链接！！</p>
<!--more-->

<br>

<h1 id="javascript对象基础"><a href="#javascript对象基础" class="headerlink" title="javascript对象基础"></a>javascript对象基础</h1><p>本节将学习有关对象基础的语法，并且回顾一些之前学习过的 JavaScript 的一些特点，使你明白你所使用过的一些功能实际上是由对象提供的。</p>
<p>我们将用以下 <span id="exercises"></span>oojs-exercises.html 作为基础探索对象的基础语法：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Object-oriented JavaScript example<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>This example requires you to enter commands in your browser&#x27;s JavaScript console (see <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://developer.mozilla.org/en-US/docs/Learn/Common_questions/What_are_browser_developer_tools&quot;</span>&gt;</span>What are browser developer tools<span class="tag">&lt;/<span class="name">a</span>&gt;</span> for more information).<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="对象基础"><a href="#对象基础" class="headerlink" title="对象基础"></a>对象基础</h2><p>对象是一个包含相关数据和方法的集合（通常由一些变量和函数组成，我们称之为对象里面的属性和方法）。</p>
<p>如同 Javascript 中的很多东西一样，创建一个对象通常先定义初始化变量。 尝试在您已有的文件中 JavaScript 代码下面输入以下内容, 保存刷新页面:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;&#125;;</span><br></pre></td></tr></table></figure>

<p>如果你在浏览器控制台输入 person，你会得到如下结果：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[object <span class="title class_">Object</span>]</span><br></pre></td></tr></table></figure>

<p>这是一个空对象，因此更新下我们的对象：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">  name : [<span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Smith&#x27;</span>],</span><br><span class="line">  age : <span class="number">32</span>,</span><br><span class="line">  gender : <span class="string">&#x27;male&#x27;</span>,</span><br><span class="line">  interests : [<span class="string">&#x27;music&#x27;</span>, <span class="string">&#x27;skiing&#x27;</span>],</span><br><span class="line">  bio : <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">name</span>[<span class="number">0</span>] + <span class="string">&#x27; &#x27;</span> + <span class="variable language_">this</span>.<span class="property">name</span>[<span class="number">1</span>] + <span class="string">&#x27; is &#x27;</span> + <span class="variable language_">this</span>.<span class="property">age</span> + <span class="string">&#x27; years old. He likes &#x27;</span> + <span class="variable language_">this</span>.<span class="property">interests</span>[<span class="number">0</span>] + <span class="string">&#x27; and &#x27;</span> + <span class="variable language_">this</span>.<span class="property">interests</span>[<span class="number">1</span>] + <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">greeting</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&#x27;Hi! I\&#x27;m &#x27;</span> + <span class="variable language_">this</span>.<span class="property">name</span>[<span class="number">0</span>] + <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>保存刷新后, 尝试在你的浏览器控制台输入下面的内容:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">person.<span class="property">name</span>[<span class="number">0</span>]</span><br><span class="line">person.<span class="property">age</span></span><br><span class="line">person.<span class="property">interests</span>[<span class="number">1</span>]</span><br><span class="line">person.<span class="title function_">bio</span>()</span><br><span class="line">person.<span class="title function_">greeting</span>()</span><br></pre></td></tr></table></figure>

<p>对象成员的值可以是任意的，在我们的 person 对象里有字符串、数字、两个数组和两个函数。前4个成员是资料项目，被称为对象的<strong>属性</strong>；后两个成员是函数，允许对象对资料做一些操作，被称为对象的<strong>方法</strong>。</p>
<p>一个对象由许多的成员组成，每一个成员都拥有一个名字，和一个值。每一个名字&#x2F;值（name&#x2F;value）对被逗号分隔开，并且名字和值之间由冒号（:）分隔，语法规则如下所示：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> objectName = &#123;</span><br><span class="line">  member1Name : member1Value,</span><br><span class="line">  member2Name : member2Value,</span><br><span class="line">  member3Name : member3Value</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>一个如上所示的对象被称之为对象的**字面量(literal)**——手动的写出对象的内容来创建一个对象。不同于从类实例化一个对象，我们会在后面学习这种方式。</p>
<p>当你想要传输一些有结构和关联的资料时常见的方式是使用字面量来创建一个对象，举例来说，发起一个请求到服务器以存储一些数据到数据库，发送一个对象要比分别发送这些数据更有效率，而且比起数组更为易用，因为你使用名字(name)来标识这些资料。</p>
<br>

<h2 id="创建对象"><a href="#创建对象" class="headerlink" title="创建对象"></a>创建对象</h2><p>Javascript 没有像许多面向对象的语言一样有用于创建 class 类的声明，而是用一种称为<strong>构建函数</strong>的特殊函数来定义对象和它们的特征。<strong>构建函数</strong>提供了创建你所需对象（实例）的有效方法，将对象的数据和特征函数<strong>按需联结</strong>至相应对象。</p>
<p>JavaScript 在对象间使用和其它语言的共享机制不同，JavaScript 构建函数创建的新实例的特征并非全盘复制，而是通过一个叫做<strong>原形链</strong>的参考链链接过去的，因此这个新实例算不上真正的实例。</p>
<p>除了直接声明一个对象，我们还可以使用构造函数、Object()构造函数 和 create()  方法创建对象。</p>
<br>

<h3 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h3><p>这个构建函数是 JavaScript 版本的类。它只定义了对象的属性和方法，除了没有明确创建一个对象和返回任何值和之外，它有了您期待的函数所拥有的全部功能。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">person</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">greeting</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&#x27;Hi! I\&#x27;m &#x27;</span> + <span class="variable language_">this</span>.<span class="property">name</span> + <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>调用构建函数创建新的实例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> <span class="title function_">person</span>(<span class="string">&#x27;Bob&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> person2 = <span class="keyword">new</span> <span class="title function_">person</span>(<span class="string">&#x27;Sarah&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>上述代码中，关键字 new 跟着一个含参函数，用于告知浏览器我们想要创建一个对象，非常类似函数调用，并把结果保存到变量中。</p>
<blockquote>
<p>值得注意的是每次当我们调用构造函数时，我们都会重新定义一遍 greeting()，这不是个理想的方法。为了避免这样，我们可以在原型里定义函数，接下来我们会讲到。</p>
</blockquote>
<p>这就是利用构造函数实现 person 对象的结果：<span id="person"></span></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">person</span>(<span class="params">first, last, age, gender, interests</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = &#123;</span><br><span class="line">    <span class="string">&#x27;first&#x27;</span>: first,</span><br><span class="line">    <span class="string">&#x27;last&#x27;</span>: last</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">gender</span> = gender;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">interests</span> = interests;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">bio</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">name</span>.<span class="property">first</span> + <span class="string">&#x27; &#x27;</span> + <span class="variable language_">this</span>.<span class="property">name</span>.<span class="property">last</span> + <span class="string">&#x27; is &#x27;</span> + <span class="variable language_">this</span>.<span class="property">age</span> + <span class="string">&#x27; years old. He likes &#x27;</span> + <span class="variable language_">this</span>.<span class="property">interests</span>[<span class="number">0</span>] + <span class="string">&#x27; and &#x27;</span> + <span class="variable language_">this</span>.<span class="property">interests</span>[<span class="number">1</span>] + <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">greeting</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&#x27;Hi! I\&#x27;m &#x27;</span> + <span class="variable language_">this</span>.<span class="property">name</span>.<span class="property">first</span> + <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<br>

<h3 id="Object-构造函数"><a href="#Object-构造函数" class="headerlink" title="Object()构造函数"></a>Object()构造函数</h3><p>使用 <code>Object()</code> 构造函数创建一个新对象：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br></pre></td></tr></table></figure>

<p>然后, 可以根据需要, 使用点或括号表示法向此对象添加属性和方法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">person1.<span class="property">name</span> = <span class="string">&#x27;Chris&#x27;</span>;</span><br><span class="line">person1[<span class="string">&#x27;age&#x27;</span>] = <span class="number">38</span>;</span><br><span class="line">person1.<span class="property">greeting</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">&#x27;Hi! I\&#x27;m &#x27;</span> + <span class="variable language_">this</span>.<span class="property">name</span> + <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>还可以将对象文本传递给Object() 构造函数作为参数，用属性&#x2F;方法填充它：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> <span class="title class_">Object</span>(&#123;</span><br><span class="line">  name : <span class="string">&#x27;Chris&#x27;</span>,</span><br><span class="line">  age : <span class="number">38</span>,</span><br><span class="line">  greeting : <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&#x27;Hi! I\&#x27;m &#x27;</span> + <span class="variable language_">this</span>.<span class="property">name</span> + <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<br>

<h3 id="create-方法"><a href="#create-方法" class="headerlink" title="create()方法"></a>create()方法</h3><p>JavaScript 有个内嵌的方法 <code>create()</code>，可以基于现有对象创建新的对象：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person2 = <span class="title class_">Object</span>.<span class="title function_">create</span>(person1);</span><br></pre></td></tr></table></figure>

<p>person2 是基于 person1 创建的，它们具有相同的属性和方法。</p>
<br>

<h2 id="设置对象成员"><a href="#设置对象成员" class="headerlink" title="设置对象成员"></a>设置对象成员</h2><p>更新对象成员的值：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">person.<span class="property">age</span> = <span class="number">45</span></span><br><span class="line">person[<span class="string">&#x27;name&#x27;</span>][<span class="string">&#x27;last&#x27;</span>] = <span class="string">&#x27;Cratchit&#x27;</span></span><br></pre></td></tr></table></figure>

<p>创建新的成员：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">person[<span class="string">&#x27;eyes&#x27;</span>] = <span class="string">&#x27;hazel&#x27;</span></span><br><span class="line">person.<span class="property">farewell</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123; <span class="title function_">alert</span>(<span class="string">&quot;Bye everybody!&quot;</span>) &#125;</span><br></pre></td></tr></table></figure>

<p>括号表示法不仅可以动态的去设置<strong>对象成员的值</strong>；还可以动态的去设置<strong>成员的名字</strong>。</p>
<p>比如说，我们想让用户能够在他们的数据里存储自己定义的值类型，通过两个 input 框来输入成员的名字和值：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myDataName = nameInput.<span class="property">value</span></span><br><span class="line"><span class="keyword">var</span> myDataValue = nameValue.<span class="property">value</span></span><br></pre></td></tr></table></figure>

<p>我们可以这样把这个新的成员的名字和值加到 person 对象里：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">person[myDataName] = myDataValue</span><br></pre></td></tr></table></figure>

<p>这是使用点表示法无法做到的，<strong>点表示法只能接受字面量的成员的名字，不接受变量作为名字</strong>。</p>
<br>

<h2 id="访问对象"><a href="#访问对象" class="headerlink" title="访问对象"></a>访问对象</h2><p>当创建好一个对象后，我们需要访问对象内的属性和方法。现在有两种方法可以使用：点表示法、括号表示法。</p>
<br>

<h3 id="点表示法"><a href="#点表示法" class="headerlink" title="点表示法"></a>点表示法</h3><p>在上面的例子中，你使用了<strong>点表示法</strong>来访问对象的属性和方法。对象的名字表现为一个<strong>命名空间</strong>，它必须写在第一位——当你想访问对象内部的属性或方法时，然后是一个点(.)，紧接着是你想要访问的项目：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">person.<span class="property">age</span>    <span class="comment">//属性的名字</span></span><br><span class="line">person.<span class="property">interests</span>[<span class="number">1</span>]    <span class="comment">//数组属性的一个子元素</span></span><br><span class="line">person.<span class="title function_">bio</span>()    <span class="comment">//对象的方法调用</span></span><br></pre></td></tr></table></figure>

<br>

<p><strong>子命名空间</strong>：可以用一个对象来做另一个对象成员的值。</p>
<p>例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">name : [<span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Smith&#x27;</span>],</span><br><span class="line"></span><br><span class="line"><span class="comment">//改成</span></span><br><span class="line"></span><br><span class="line">name : &#123;</span><br><span class="line">  first : <span class="string">&#x27;Bob&#x27;</span>,</span><br><span class="line">  last : <span class="string">&#x27;Smith&#x27;</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>这样，我们实际上创建了一个<strong>子命名空间</strong>，当你想访问它时，你只需要链式的再使用一次点表示法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">person.<span class="property">name</span>.<span class="property">first</span></span><br><span class="line">person.<span class="property">name</span>.<span class="property">last</span></span><br></pre></td></tr></table></figure>

<br>

<h3 id="括号表示法"><a href="#括号表示法" class="headerlink" title="括号表示法"></a>括号表示法</h3><p>使用括号表示法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">person.<span class="property">age</span></span><br><span class="line">person.<span class="property">name</span>.<span class="property">first</span></span><br></pre></td></tr></table></figure>

<p>使用如下所示的代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">person[<span class="string">&#x27;age&#x27;</span>]</span><br><span class="line">person[<span class="string">&#x27;name&#x27;</span>][<span class="string">&#x27;first&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>这看起来很像访问一个数组的元素，从根本上来说是一回事儿，你使用了关联了值的名字，而不是索引去选择元素。因此对象有时被称之为<strong>关联数组</strong>（对象做了字符串到值的映射，而数组做的是数字到值的映射）。</p>
<blockquote>
<p>注：每个页面在加载完毕后，会有一个 Document 的实例被创建，叫做 document，它代表了整个页面的结构，内容和一些功能，比如页面的 URL。同样的，这意味 document 有一些可用的方法和属性。例如，<code>document.createElement(&#39;div&#39;);</code> 和 <code>document.querySelector(&#39;video&#39;);</code>。</p>
</blockquote>
<br>

<h2 id="this的含义"><a href="#this的含义" class="headerlink" title="this的含义"></a>this的含义</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">greeting</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">&#x27;Hi! I\&#x27;m &#x27;</span> + <span class="variable language_">this</span>.<span class="property">name</span>.<span class="property">first</span> + <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>关键字 this 指向了当前代码运行时的对象，它保证了当代码的上下文改变时变量的值的正确性（比如：不同的person对象拥有不同的name这个属性，很明显greeting这个方法需要使用的是它们自己的name）。</p>
<p>例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person1 = &#123;</span><br><span class="line">  name : <span class="string">&#x27;Chris&#x27;</span>,</span><br><span class="line">  <span class="attr">greeting</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&#x27;Hi! I\&#x27;m &#x27;</span> + <span class="variable language_">this</span>.<span class="property">name</span> + <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person2 = &#123;</span><br><span class="line">  name : <span class="string">&#x27;Brian&#x27;</span>,</span><br><span class="line">  <span class="attr">greeting</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&#x27;Hi! I\&#x27;m &#x27;</span> + <span class="variable language_">this</span>.<span class="property">name</span> + <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在这里，person1.greeting() 会输出：”Hi! I’m Chris.”；person2.greeting() 会输出：”Hi! I’m Brain.”，即使 greeting 这个方法的代码是一样的。在字面量的对象里this看起来不是很有用，但是当你动态创建一个对象（例如使用构造器）时它是非常有用的。</p>
<br>

<h1 id="对象原型"><a href="#对象原型" class="headerlink" title="对象原型"></a>对象原型</h1><p>通过原型这种机制，JavaScript 中的对象从其他对象集成功能特性。这种继承机制与经典的面对对象编程语言的继承机制不同。本文将探讨这些差别，解释原型链如何工作，并了解如何通过 prototype 属性向已有的构造器添加方法。</p>
<br>

<h2 id="基于原型的语言"><a href="#基于原型的语言" class="headerlink" title="基于原型的语言"></a>基于原型的语言</h2><p>Javascript 常被描述为一种<strong>基于原型的语言(prototype-based language)<strong>，每个对象拥有一个</strong>原型对象</strong>，对象以原型为模板、从原型继承方法和属性。原型对象也可以拥有原型，并从中继承方法和属性，一层一层、以此类推。这种关系被称为**原型链(prototype chaim)**，他解释了为何一个对象会拥有定义在其他对象中的属性和方法。</p>
<p>在传统的 OOP 中，首先定义类，以及创建对象实例，类中定义的所有属性和方法都被复制到实例中。在 JavaScript 中并不是这样，而是在对象实例和它的构造器之间建立一个连接（它是对象的 <code>__proto__</code> 属性，是从构造函数的 prototype 属性派生的），之后通过上溯原型链，在构造器中找到这些属性和方法。</p>
<blockquote>
<p> 注：理解对象的原型（可以通过 <code>Object.getPrototypeOf(obj)</code> 或者已被弃用的 <code>__proto__</code> 属性获得）与构造函数的 prototype 属性之间的区别是很重要的。前者是每个实例上都有的属性，后者是构造函数的属性。也就是说，<code>Object.getPrototypeOf(new Foobar())</code> 和 <code>Foobar.prototype</code> 指向着同一个对象。</p>
</blockquote>
<br>

<h2 id="使用javascript中的原型"><a href="#使用javascript中的原型" class="headerlink" title="使用javascript中的原型"></a>使用javascript中的原型</h2><p>在 javascript 中，每个函数都有一个特殊的属性叫作原型（prototype），正如下面所展示的。打开一个控制台，复制粘贴下面的 JavaScript 代码，然后运行：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">doSomething</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( doSomething.<span class="property"><span class="keyword">prototype</span></span> );</span><br><span class="line"><span class="comment">// It does not matter how you declare the function, a</span></span><br><span class="line"><span class="comment">//  function in javascript will always have a default</span></span><br><span class="line"><span class="comment">//  prototype property.</span></span><br><span class="line"><span class="keyword">var</span> doSomething = <span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( doSomething.<span class="property"><span class="keyword">prototype</span></span> );</span><br></pre></td></tr></table></figure>

<p>正如上面所看到的, doSomething 构造函数和对象都有一个默认的原型属性：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">constructor</span>: ƒ <span class="title function_">doSomething</span>(),</span><br><span class="line">    <span class="attr">__proto__</span>: &#123;</span><br><span class="line">        <span class="attr">constructor</span>: ƒ <span class="title class_">Object</span>(),</span><br><span class="line">        <span class="attr">hasOwnProperty</span>: ƒ <span class="title function_">hasOwnProperty</span>(),</span><br><span class="line">        <span class="attr">isPrototypeOf</span>: ƒ <span class="title function_">isPrototypeOf</span>(),</span><br><span class="line">        <span class="attr">propertyIsEnumerable</span>: ƒ <span class="title function_">propertyIsEnumerable</span>(),</span><br><span class="line">        <span class="attr">toLocaleString</span>: ƒ <span class="title function_">toLocaleString</span>(),</span><br><span class="line">        <span class="attr">toString</span>: ƒ <span class="title function_">toString</span>(),</span><br><span class="line">        <span class="attr">valueOf</span>: ƒ <span class="title function_">valueOf</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>现在，我们可以添加一些属性到 doSomething 的原型上面：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">doSomething</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line">doSomething.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">foo</span> = <span class="string">&quot;bar&quot;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( doSomething.<span class="property"><span class="keyword">prototype</span></span> );</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">foo</span>: <span class="string">&quot;bar&quot;</span>,   <span class="comment">//ownproperty 属性</span></span><br><span class="line">    <span class="attr">constructor</span>: ƒ <span class="title function_">doSomething</span>(),</span><br><span class="line">    <span class="attr">__proto__</span>: &#123;</span><br><span class="line">        <span class="attr">constructor</span>: ƒ <span class="title class_">Object</span>(),</span><br><span class="line">        <span class="attr">hasOwnProperty</span>: ƒ <span class="title function_">hasOwnProperty</span>(),</span><br><span class="line">        <span class="attr">isPrototypeOf</span>: ƒ <span class="title function_">isPrototypeOf</span>(),</span><br><span class="line">        <span class="attr">propertyIsEnumerable</span>: ƒ <span class="title function_">propertyIsEnumerable</span>(),</span><br><span class="line">        <span class="attr">toLocaleString</span>: ƒ <span class="title function_">toLocaleString</span>(),</span><br><span class="line">        <span class="attr">toString</span>: ƒ <span class="title function_">toString</span>(),</span><br><span class="line">        <span class="attr">valueOf</span>: ƒ <span class="title function_">valueOf</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<p>使用 new 运算符来在现在的这个原型基础之上，创建一个 doSomething 的实例，并在这个对象上面添加一些属性：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">doSomething</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line">doSomething.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">foo</span> = <span class="string">&quot;bar&quot;</span>; <span class="comment">// add a property onto the prototype</span></span><br><span class="line"><span class="keyword">var</span> doSomeInstancing = <span class="keyword">new</span> <span class="title function_">doSomething</span>();</span><br><span class="line">doSomeInstancing.<span class="property">prop</span> = <span class="string">&quot;some value&quot;</span>; <span class="comment">// add a property onto the object</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( doSomeInstancing );</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">prop</span>: <span class="string">&quot;some value&quot;</span>,</span><br><span class="line">    <span class="attr">__proto__</span>: &#123;</span><br><span class="line">        <span class="attr">foo</span>: <span class="string">&quot;bar&quot;</span>,</span><br><span class="line">        <span class="attr">constructor</span>: ƒ <span class="title function_">doSomething</span>(),</span><br><span class="line">        <span class="attr">__proto__</span>: &#123;</span><br><span class="line">            <span class="attr">constructor</span>: ƒ <span class="title class_">Object</span>(),</span><br><span class="line">            <span class="attr">hasOwnProperty</span>: ƒ <span class="title function_">hasOwnProperty</span>(),</span><br><span class="line">            <span class="attr">isPrototypeOf</span>: ƒ <span class="title function_">isPrototypeOf</span>(),</span><br><span class="line">            <span class="attr">propertyIsEnumerable</span>: ƒ <span class="title function_">propertyIsEnumerable</span>(),</span><br><span class="line">            <span class="attr">toLocaleString</span>: ƒ <span class="title function_">toLocaleString</span>(),</span><br><span class="line">            <span class="attr">toString</span>: ƒ <span class="title function_">toString</span>(),</span><br><span class="line">            <span class="attr">valueOf</span>: ƒ <span class="title function_">valueOf</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2021/03/18/JavaScript%E5%AF%B9%E8%B1%A1%E4%BB%8B%E7%BB%8D/2.png"></p>
<p>所以回过头来每个实例对象（ object ）都有一个私有属性（称之为proto）指向它的构造函数的原型对象（prototype），就像上面看到的，doSomeInstancing 的 <code>__proto__</code> 属性就是 doSomething.prototype。</p>
<p>当你访问 doSomeInstancing 的一个属性, 浏览器首先查找 doSomeInstancing 是否有这个属性。如果 doSomeInstancing 没有这个属性, 然后浏览器就会在 doSomeInstancing 的 <code>__proto__</code> 中查找这个属性(也就是 doSomething.prototype)。如果 doSomeInstancing 的 <code>__proto__</code> 有这个属性, 那么 doSomeInstancing 的 <code>__proto__</code> 上的这个属性就会被使用。否则, 如果 doSomeInstancing 的 <code>__proto__</code> 没有这个属性。浏览器就会去查找 doSomeInstancing 的 <code>__proto__</code> 的 <code>__proto__</code>，看它是否有这个属性。默认情况下, 所有函数的原型的 <code>__proto__</code> 属性就是 window.Object.prototype。所以 doSomeInstancing 的 <code>__proto__</code> 的 <code>__proto__</code>（也就是 doSomething.prototype 的 <code>__proto__</code>(也就是 Object.prototype)）会被查找是否有这个属性。如果没有在它里面找到这个属性，然后就会在 doSomeInstancing 的 <code>__proto__</code> 的 <code>__proto__</code> 的 <code>__proto__</code> 里面查找。然而这有一个问题: doSomeInstancing 的 <code>__proto__</code> 的 <code>__proto__</code> 的 <code>__proto__</code> 不存在。最后, 原型链上面的所有的 <code>__proto__</code> 都被找完了，浏览器所有已经声明了的 <code>__proto__</code> 上都不存在这个属性，然后就得出结论，这个属性是 undefined。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">doSomething</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line">doSomething.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">foo</span> = <span class="string">&quot;bar&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> doSomeInstancing = <span class="keyword">new</span> <span class="title function_">doSomething</span>();</span><br><span class="line">doSomeInstancing.<span class="property">prop</span> = <span class="string">&quot;some value&quot;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;doSomeInstancing.prop:      &quot;</span> + doSomeInstancing.<span class="property">prop</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;doSomeInstancing.foo:       &quot;</span> + doSomeInstancing.<span class="property">foo</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;doSomething.prop:           &quot;</span> + doSomething.<span class="property">prop</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;doSomething.foo:            &quot;</span> + doSomething.<span class="property">foo</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;doSomething.prototype.prop: &quot;</span> + doSomething.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">prop</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;doSomething.prototype.foo:  &quot;</span> + doSomething.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">foo</span>);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">doSomeInstancing.<span class="property">prop</span>:      some value</span><br><span class="line">doSomeInstancing.<span class="property">foo</span>:       bar</span><br><span class="line">doSomething.<span class="property">prop</span>:           <span class="literal">undefined</span></span><br><span class="line">doSomething.<span class="property">foo</span>:            <span class="literal">undefined</span></span><br><span class="line">doSomething.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">prop</span>: <span class="literal">undefined</span></span><br><span class="line">doSomething.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">foo</span>:  bar</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注：没有官方的方法用于直接访问一个对象的原型对象——原型链中的“连接”被定义在一个内部属性中，在 JavaScript 语言标准中用 [[prototype]]。然而，大多数现代浏览器还是提供了一个名为 <code>__proto__</code> 的属性，其包含了对象的原型。你可以尝试输入 <code>object.__proto__</code> 和 <code>person1.__proto__.__proto__</code>，看看代码中的原型链是什么样的！</p>
</blockquote>
<blockquote>
<p>就我个人理解来说，构造函数的 prototype 属性一开始创建的时候就是其本身，这个原型对象的所有属性供给 new doSomething() 生成实例对象继承，给构造函数添加属性会添加到构造函数实例对象的属性之中（doSomething是函数，当然也是一个对象，但它是靠new Function()生成的实例对象），而且因为不在原型之中是后来添加的所以不会被继承。给实例对象添加属性默认是私有属性而不是添加到原型之中。</p>
<p><img src="/2021/03/18/JavaScript%E5%AF%B9%E8%B1%A1%E4%BB%8B%E7%BB%8D/1.png"></p>
<p>所以如果执行doSomething.foo，它会在Function.prototype上找foo这个属性，结果没找到，自然是undefined。不过由于在上图第一个例子中添加了 foo 属性，会返回 ‘bar’。</p>
<p><img src="/2021/03/18/JavaScript%E5%AF%B9%E8%B1%A1%E4%BB%8B%E7%BB%8D/4.png"></p>
<p>一句话：构造函数的原型对象是给构造函数生成的实例对象用的，而不是给构造函数自己用的。</p>
<p><img src="/2021/03/18/JavaScript%E5%AF%B9%E8%B1%A1%E4%BB%8B%E7%BB%8D/2.png"></p>
</blockquote>
<br>

<h2 id="prototype属性"><a href="#prototype属性" class="headerlink" title="prototype属性"></a>prototype属性</h2><p>那么，那些继承的属性和方法在哪儿定义呢？如果你查看 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object">Object 参考页</a>，会发现左侧列出许多属性和方法——大大超过我们在 person1 对象中看到的继承成员的数量。某些属性或方法被继承了，而另一些没有——为什么呢？</p>
<p>原因在于，对象所继承的属性和方法是定义在 <code>prototype</code> 属性之上的（你可以称之为子命名空间）那些以 <code>Object.prototype.</code> 开头的属性，而非仅仅以 <code>Object.</code> 开头的属性。<code>prototype</code> 属性的值是一个对象，我们希望被原型链下游的对象继承的属性和方法，都被储存在其中。</p>
<p>于是 <code>Object.prototype.watch()</code>、<code>Object.prototype.valueOf()</code> 等等成员，适用于任何继承自 <code>Object()</code> 的对象类型，包括使用构造器创建的新的对象实例。</p>
<p><code>Object.is()</code>、<code>Object.keys()</code>，以及其他不在 <code>prototype</code> 对象内的成员，不会被“对象实例”或“继承自 <code>Object()</code> 的对象类型”所继承。这些方法&#x2F;属性仅能被 <code>Object()</code> 构造器自身使用。</p>
<blockquote>
<p>注：这看起来很奇怪，构造器本身就是函数，你怎么可能在构造器这个函数中定义一个方法呢？但其实函数也是一个对象类型，你可以查阅 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function">Function() 构造器</a>的参考文档以确认这一点。</p>
</blockquote>
<p>在控制台输入尝试：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span></span><br></pre></td></tr></table></figure>

<p>你会看到 Object 的 prototype 属性上定义了大量的方法；如前所示，继承自 Object 的对象都可以使用这些方法。</p>
<p>JavaScript 中到处都是通过原型链继承的例子。比如，你可以尝试从 String、Date、Number 和 Array 全局对象的原型中寻找方法和属性。它们都在原型上定义了一些方法，因此当你创建一个字符串时：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myString = <span class="string">&#x27;This is my string.&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>myString 立即具有了一些有用的方法，如 split()、indexOf()、replace() 等。</p>
<blockquote>
<p>重要：prototype 属性大概是 JavaScript 中最容易混淆的名称之一。你可能会认为，this 关键字指向当前对象的原型对象，其实不是（原型对象是一个内部对象，应当使用 <code>__proto__</code> 访问）。prototype 属性指向一个对象，你在这个对象中定义需要被继承的成员。</p>
</blockquote>
<br>

<h2 id="create"><a href="#create" class="headerlink" title="create()"></a>create()</h2><p>我们讲过如何用 Object.create() 方法创建新的对象实例。</p>
<p>例如，在 JavaScript 控制台中输入：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">person</span>(<span class="params"></span>)&#123;&#125;;</span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> <span class="title function_">person</span>();</span><br><span class="line"><span class="keyword">var</span> person2 = <span class="title class_">Object</span>.<span class="title function_">create</span>(person1);</span><br></pre></td></tr></table></figure>

<p><code>create()</code> 实际做的是从指定原型对象创建一个新的对象。这里以 person1 为原型对象创建了 person2 对象。在控制台输入：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">person2.<span class="property">__proto__</span></span><br></pre></td></tr></table></figure>

<p>结果返回对象 person。</p>
<p><img src="/2021/03/18/JavaScript%E5%AF%B9%E8%B1%A1%E4%BB%8B%E7%BB%8D/5.png"></p>
<br>

<h2 id="constructor属性"><a href="#constructor属性" class="headerlink" title="constructor属性"></a>constructor属性</h2><p>每个实例对象都从原型中继承了一个 constructor 属性，该属性<strong>指向</strong>了用于构造此实例对象的构造函数。</p>
<p>例如，在控制台中尝试下面的指令：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">person1.<span class="property">constructor</span></span><br><span class="line">person2.<span class="property">constructor</span></span><br></pre></td></tr></table></figure>

<p>都将返回 person() 构造器，因为该构造器包含这些实例的原始定义。</p>
<p>一个小技巧是，你可以在 constructor 属性的末尾添加一对圆括号（括号中包含所需的参数），从而用这个构造器创建另一个对象实例。毕竟构造器是一个函数，故可以通过圆括号调用；只需在前面添加 new 关键字，便能将此函数作为构造器使用。</p>
<p>在控制台中输入：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person3 = <span class="keyword">new</span> person1.<span class="title function_">constructor</span>(<span class="params"><span class="string">&#x27;Karen&#x27;</span>, <span class="string">&#x27;Stephenson&#x27;</span>, <span class="number">26</span>, <span class="string">&#x27;female&#x27;</span>, [<span class="string">&#x27;playing drums&#x27;</span>, <span class="string">&#x27;mountain climbing&#x27;</span>]</span>);</span><br></pre></td></tr></table></figure>

<p>通常不会去用这种方法创建新的实例；但如果因为某些原因<strong>没有原始构造器的引用</strong>，这种方法就很有用了。</p>
<p>此外，constructor 属性还有其他用途。比如，想要获得某个对象实例的构造器的名字，可以这么用：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">instanceName.<span class="property">constructor</span>.<span class="property">name</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="修改原型"><a href="#修改原型" class="headerlink" title="修改原型"></a>修改原型</h2><p>从我们从下面这个例子来看一下如何修改构造器的 prototype 属性。</p>
<p>回到 <a href="#exercises">oojs-exercises.html</a> 的例子，在本地为源代码创建一个副本。在已有的 JavaScript 的末尾添加如下代码，这段代码将为 <a href="#person">person 构造器</a>的 prototype 属性添加一个新的方法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">person.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">farewell</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">name</span>.<span class="property">first</span> + <span class="string">&#x27; has left the building. Bye for now!&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>保存代码，在浏览器中加载页面，然后在控制台输入：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">person1.<span class="title function_">farewell</span>();</span><br></pre></td></tr></table></figure>

<p>你会看到一条警告信息，其中还显示了构造器中定义的人名。更关键的是：<strong>整条继承链动态地更新了，任何由此构造器创建的对象实例都自动获得了这个方法。</strong></p>
<p>再想一想这个过程。我们的代码中定义了构造器，然后用这个构造器创建了一个对象实例，此后向构造器的 prototype 添加了一个新的方法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">person</span>(<span class="params">first, last, age, gender, interests</span>) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 属性与方法定义</span></span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&#x27;Tammi&#x27;</span>, <span class="string">&#x27;Smith&#x27;</span>, <span class="number">32</span>, <span class="string">&#x27;neutral&#x27;</span>, [<span class="string">&#x27;music&#x27;</span>, <span class="string">&#x27;skiing&#x27;</span>, <span class="string">&#x27;kickboxing&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">person.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">farewell</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">name</span>.<span class="property">first</span> + <span class="string">&#x27; has left the building. Bye for now!&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2021/03/18/JavaScript%E5%AF%B9%E8%B1%A1%E4%BB%8B%E7%BB%8D/7.png"></p>
<p>这样，旧有对象实例的可用功能被自动更新了。这种继承模型下，上游对象的方法不会复制到下游的对象实例中；下游对象本身虽然没有定义这些方法。但浏览器会通过上溯原型链、从上游对象中找到它们，提供了一个强大而可扩展的功能系统。</p>
<p>不过，你很少看到属性定义在 prototype 属性中，因为如此定义不够灵活。比如，你可以添加一个属性：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">person.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">fullName</span> = <span class="string">&#x27;Bob Smith&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>但人不可能都叫这个名字。用 name.first 和 name.last 组成 fullName ：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">person.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">fullName</span> = <span class="variable language_">this</span>.<span class="property">name</span>.<span class="property">first</span> + <span class="string">&#x27; &#x27;</span> + <span class="variable language_">this</span>.<span class="property">name</span>.<span class="property">last</span>;</span><br></pre></td></tr></table></figure>

<p><img src="/2021/03/18/JavaScript%E5%AF%B9%E8%B1%A1%E4%BB%8B%E7%BB%8D/6.png"></p>
<p>然而，这么做是无效的，因为本例中 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/this">this</a> 引用全局范围（无论是否在严格模式下，在全局执行环境中{在任何函数体外部}this 都指向全局对象），而非函数范围（在函数内部，this 的值取决于函数被调用的方式）。访问这个属性只会得到 undefined undefined。this 指向了原型对象，导致在构造函数中定义的属性无法和添加在原型中的属性灵活交互。但这个语句若放在 先前定义在 prototype 上的方法中则有效，因为此时语句位于函数范围内，从而能够成功地转换为对象实例范围。你可能会在 prototype 上定义常属性（不变的属性），但一般来说，在构造器内定义属性更好。</p>
<p><strong>事实上，一种极其常见的对象定义模式是，在构造器（函数体）中定义属性、在 prototype 属性上定义方法（属性值可变无法继承，方法不变并继承）。</strong>如此，构造器只包含属性定义，而方法则分装在不同的代码块，代码更具可读性。而且，<strong>由于属性定义在构造函数中，属性是无法继承的，即属性不在原型里。</strong>例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 构造器及其属性定义</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Test</span>(<span class="params">a,b,c,d</span>) &#123;</span><br><span class="line">  <span class="comment">// 属性定义</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义第一个方法</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Test</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">x</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123; ... &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义第二个方法</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Test</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">y</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123; ... &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 等等……</span></span><br></pre></td></tr></table></figure>
<p>在 Piotr Zalewa 的 <a target="_blank" rel="noopener" href="https://github.com/zalun/school-plan-app/blob/master/stage9/js/index.js">school plan app</a> 样例中可以看到这种模式。</p>
<br>

<h1 id="javascript中的继承"><a href="#javascript中的继承" class="headerlink" title="javascript中的继承"></a>javascript中的继承</h1><p>了解了 OOJS 的大多数细节后，接下来将介绍如何创建子对象类别（构造器）并从父类别中继承功能。</p>
<br>

<h2 id="原型式的继承"><a href="#原型式的继承" class="headerlink" title="原型式的继承"></a>原型式的继承</h2><p>到目前为止我们已经了解了一些关于原型链的实现方式以及成员变量是如何通过它来实现继承，但是之前涉及到的大部分都是浏览器内置函数（比如 String、Date、Number 和 Array），那么我们自己如何创建一个继承自另一对象的JavaScript对象呢？</p>
<p>正如前面课程所提到的，有些人认为 JavaScript 并不是真正的面向对象语言，在经典的面向对象语言中，你可能倾向于定义类对象，然后可以简单地定义哪些类继承哪些类，JavaScript 使用了另一套实现方式，继承的对象函数并不是通过复制而来，而是通过原型链继承（通常被称为 原型式继承 —— prototypal inheritance）。</p>
<br>

<p>将 <a target="_blank" rel="noopener" href="https://github.com/a-pin/learning-area/blob/main/javascript/oojs/advanced/oojs-start.html">oojs-start.html</a> 文件复制到您本地，你能看到一个只定义了一些属性的 Person() 构造器：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">first, last, age, gender, interests</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = &#123;</span><br><span class="line">    first,</span><br><span class="line">    last</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">gender</span> = gender;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">interests</span> = interests;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>所有的方法都定义在构造器的原型上，比如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">greeting</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">&#x27;Hi! I\&#x27;m &#x27;</span> + <span class="variable language_">this</span>.<span class="property">name</span>.<span class="property">first</span> + <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<br>

<h2 id="定义Teacher-构造器函数"><a href="#定义Teacher-构造器函数" class="headerlink" title="定义Teacher()构造器函数"></a>定义Teacher()构造器函数</h2><p>假如，我们想要创建一个 Teacher 类，这个类不仅会继承 Person 的所有成员，也包括：</p>
<ul>
<li>一个新的属性：subject 这个属性包含了教师教授的学科。</li>
<li>一个被更新的 greeting() 方法，这个方法打招呼听起来比一般的 greeting() 方法更正式一点。</li>
</ul>
<p>我们要做的第一件事是创建一个 Teacher() 构造器——将下面的代码加入到现有代码之下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Teacher</span>(<span class="params">first, last, age, gender, interests, subject</span>) &#123;</span><br><span class="line">  <span class="title class_">Person</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>, first, last, age, gender, interests);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">subject</span> = subject;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里有一个我们从没见过的函数——<a target="_blank" rel="noopener" href="https://www.w3school.com.cn/js/js_function_call.asp"><code>call()</code>函数</a>。</p>
<p>call() 方法调用一个函数, 其具有一个指定的 this 值和参数列表，改变 this 指针的指向。可以让 call() 中的对象调用当前对象所拥有的函数。</p>
<p>第一个参数指定了 this值——将 Teacher 函数作为 Person 构造函数的 this 值。你可以在接下来的参数列表指定参数作为 Person 构造函数的参数，为 Teacher() 创建了要继承的属性。</p>
<blockquote>
<p>注：在这个例子里我们在创建一个新的对象实例时同时指派了继承的所有属性，但是你需要在构造器里将它们作为参数来指派，即使实例不要求它们被作为参数指派（比如在创建对象的时候已经得到了一个设置为任意值的属性）</p>
</blockquote>
<p>所以在这个例子里，我们很有效的在 Teacher() 构造函数里运行了 Person() 构造函数，得到了和在 Teacher() 里定义的一样的属性，但是用的是传送给 Teacher()，而不是 Person() 的值（我们简单使用这里的this作为传给call()的this，意味着this指向Teacher()函数）。</p>
<p>在构造器里的最后一行代码简单地定义了一个新的 subject 属性，这是教师特有的属性。</p>
<p>当然，我们可以这么做：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Teacher</span>(<span class="params">first, last, age, gender, interests, subject</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = &#123;</span><br><span class="line">    first,</span><br><span class="line">    last</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">gender</span> = gender;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">interests</span> = interests;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">subject</span> = subject;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是这只是重新定义了一遍属性，并不是将他们从 Person 中继承过来的。</p>
<h3 id="从无参构造函数继承"><a href="#从无参构造函数继承" class="headerlink" title="从无参构造函数继承"></a>从无参构造函数继承</h3><p>请注意，如果您继承的构造函数不从传入的参数中获取其属性值，则不需要在call()中为其指定其他参数。例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Brick</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">width</span> = <span class="number">10</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">height</span> = <span class="number">20</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>您可以这样继承width和height属性（以及下面描述的其他步骤）：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">BlueGlassBrick</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title class_">Brick</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">opacity</span> = <span class="number">0.5</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">color</span> = <span class="string">&#x27;blue&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2021/03/18/JavaScript%E5%AF%B9%E8%B1%A1%E4%BB%8B%E7%BB%8D/8.png"></p>
<p>请注意，我们仅传入了 this 到 call() 中，因为我们不会继承那些需要参数设置的父级属性。</p>
<br>

<h2 id="设置Teacher-的原型和构造器引用"><a href="#设置Teacher-的原型和构造器引用" class="headerlink" title="设置Teacher()的原型和构造器引用"></a>设置Teacher()的原型和构造器引用</h2><p>可以看到，在使用 call() 函数继承父级对象的属性后，子对象并没有继承父对象的原型，原型默认是 Object。这就说明你没办法使用父对象（例如 Person 对象）定义在原型上的方法。</p>
<p>为了从 Person() 的原型对象里继承方法，你需要设置子对象的原型：</p>
<p>先在之前的代码后面添加这一行：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Teacher</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>);</span><br></pre></td></tr></table></figure>

<p>在这里我们用 <code>create()</code> 函数来创建一个和 Person.prototype 一样的新的<strong>原型属性值</strong>（这个属性指向一个包括属性和方法的对象），然后将其作为 Teacher.prototype 的属性值。这意味着 Teacher.prototype 现在会继承 Person.prototyp e 的所有属性和方法。</p>
<p>现在 Teacher() 的 prototype 的 constructor 属性指向的是 Person() , 这是由我们生成 Teacher() 的方式决定的。(这篇 <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/8453887/why-is-it-necessary-to-set-the-prototype-constructor">Stack Overflow post 文章</a>会告诉您详细的原理)。</p>
<p>进入JavaScript控制台，输入以下代码来确认：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Teacher</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span>;</span><br></pre></td></tr></table></figure>

<p>这或许会成为很大的问题，所以我们需要将其正确设置——您可以回到源代码，在底下加上这一行代码来解决：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Teacher</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> = <span class="title class_">Teacher</span>;</span><br></pre></td></tr></table></figure>

<p>当您保存并刷新页面以后，输入 Teacher.prototype.constructor 就会得到 Teacher()。</p>
<blockquote>
<p>注：每一个函数对象（Function）都有一个 prototype 属性，并且只有函数对象有 prototype 属性，因为 prototype 本身就是定义在 Function 对象下的属性。当我们输入类似 <code>var person1=new Person(...)</code> 来构造对象时，JavaScript实际上参考的是 <code>Person.prototype</code> 指向的对象来生成 person1。另一方面，Person() 函数是 Person.prototype 的构造函数，也就是说 Person&#x3D;&#x3D;&#x3D;Person.prototype.constructor。</p>
</blockquote>
<p>在定义新的构造函数 Teacher 时，我们通过 function.call 来调用父类的构造函数，但是这样无法自动指定 Teacher.prototype 的值，这样 Teacher.prototype 就只能包含在构造函数里构造的属性，而没有方法。因此我们利用 Object.create() 方法将 Person.prototype 作为 Teacher.prototype 的原型对象，并改变其构造器指向，使之与 Teacher 关联。</p>
<p>任何您想要被继承的方法都应该定义在构造函数的 prototype 对象里，并且永远使用父类的 prototype 来创造子类的 prototype，这样才不会打乱类继承结构。</p>
<br>

<h2 id="对象成员总结"><a href="#对象成员总结" class="headerlink" title="对象成员总结"></a>对象成员总结</h2><p>总结一下，您应该基本了解了以下三种属性或者方法：</p>
<ol>
<li>那些定义在构造器函数中的、用于给予对象实例的。这些都很容易发现——在你自己的代码中，它们是构造函数中使用 <code>this.x = x</code> 类型的行；在内置的浏览器代码中，它们是可用于对象实例的成员（通常通过使用 new 关键字调用构造函数来创建，例如 <code>var myInstance = new myConstructor()</code>）。</li>
<li>那些直接在构造函数上定义、仅在构造函数上可用的。这些通常仅在内置的浏览器对象中可用，并通过被直接链接到构造函数而不是实例来识别。 例如Object.keys()。</li>
<li>那些在构造函数原型上定义、由所有实例和对象类继承的。这些包括在构造函数的原型属性上定义的任何成员，如 <code>myConstructor.prototype.x()</code>。</li>
</ol>
<br>

<h2 id="ECMAScript-2015-类"><a href="#ECMAScript-2015-类" class="headerlink" title="ECMAScript 2015 类"></a>ECMAScript 2015 类</h2><p>ECMAScript 2015(ES6) 将类语法引入 JavaScript，使用更简单、更干净。ES6 编写可重用类（JavaScript 类是 JavaScript 对象的模板），类似于 C++ 或 Java 中的类。</p>
<p>在本节中，我们将把”人员”和”教师”示例从原型继承转换为类，以向您展示它是如何完成的。</p>
<blockquote>
<p>注：所有现代浏览器都支持这种现代的类编写方式，但是如果你处理的项目需要支持不支持此语法的浏览器（最明显的是 Internet Explorer），则仍然值得了解底层原型继承。</p>
</blockquote>
<p>让我们看一下 Person 示例的重写版本，类样式：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">first, last, age, gender, interests</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = &#123;</span><br><span class="line">      first,</span><br><span class="line">      last</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">gender</span> = gender;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">interests</span> = interests;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">greeting</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hi! I&#x27;m <span class="subst">$&#123;<span class="variable language_">this</span>.name.first&#125;</span>`</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">farewell</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.name.first&#125;</span> has left the building. Bye for now!`</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>class 语句指示我们正在创建一个新类。在这个块中，我们定义了类的所有功能：</p>
<ul>
<li><code>constructor()</code> 方法定义了表示 Person 类的构造函数。</li>
<li><code>greeting()</code> 和 <code>farewell()</code> 是类方法。任何你想要与类关联的方法都在构造函数之后定义。在此示例中，我们使用模板文本而不是字符串串联，以使代码更易于阅读。</li>
</ul>
<p>现在，我们可以使用 new 运算符实例化对象：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> han = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&#x27;Han&#x27;</span>, <span class="string">&#x27;Solo&#x27;</span>, <span class="number">25</span>, <span class="string">&#x27;male&#x27;</span>, [<span class="string">&#x27;Smuggling&#x27;</span>]);</span><br><span class="line">han.<span class="title function_">greeting</span>();</span><br><span class="line"><span class="comment">// Hi! I&#x27;m Han</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> leia = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&#x27;Leia&#x27;</span>, <span class="string">&#x27;Organa&#x27;</span>, <span class="number">19</span>, <span class="string">&#x27;female&#x27;</span>, [<span class="string">&#x27;Government&#x27;</span>]);</span><br><span class="line">leia.<span class="title function_">farewell</span>();</span><br><span class="line"><span class="comment">// Leia has left the building. Bye for now</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注：事实上在表层下，你的类正在转换为原型继承模型。</p>
</blockquote>
<br>

<h3 id="使用类语法进行继承"><a href="#使用类语法进行继承" class="headerlink" title="使用类语法进行继承"></a>使用类语法进行继承</h3><p>在本节中，我们将创建专用类，使其继承自使用现代类语法。为了创建一个子类，我们使用 <code>extends</code> 关键字来告诉 <code>JavaScript</code> 我们想要基于我们的类的类：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Teacher</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Person</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">subject, grade</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">subject</span> = subject;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">grade</span> = grade;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是这里有一点问题：与老式构造函数不同，在旧式构造函数中，new 运算符会初始化 <code>this</code> 到新分配的对象，而对于由 <code>extends</code> 关键字定义的类，它不会自动初始化。</p>
<p>因此，运行上述代码将给出错误：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Uncaught</span> <span class="title class_">ReferenceError</span>: <span class="title class_">Must</span> call <span class="variable language_">super</span> constructor <span class="keyword">in</span> derived <span class="keyword">class</span> <span class="title class_">before</span></span><br><span class="line">accessing <span class="string">&#x27;this&#x27;</span> or returning <span class="keyword">from</span> derived constructor</span><br></pre></td></tr></table></figure>

<p>对于子类，对 <code>this</code> 的初始化始终依赖于父类构造函数，即被扩展类的构造函数。对于 Teacher 类，你需要使用 <code>super()</code> 方法初始化对象以及 this 的值：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Teacher</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Person</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">subject, grade</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(); <span class="comment">// Now &#x27;this&#x27; is initialized by calling the parent constructor.</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">subject</span> = subject;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">grade</span> = grade;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>由于 <code>super()</code> 方法实际上是父类构造函数，因此需要传递必要的参数给 Person 构造函数用来初始化子类中的父类属性，从而继承它们：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Teacher</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Person</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">first, last, age, gender, interests, subject, grade</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(first, last, age, gender, interests);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// subject and grade are specific to Teacher</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">subject</span> = subject;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">grade</span> = grade;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>现在，当我们实例化 Teacher 对象时，我们可以调用在两者上定义的方法和属性。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> snape = <span class="keyword">new</span> <span class="title class_">Teacher</span>(<span class="string">&#x27;Severus&#x27;</span>, <span class="string">&#x27;Snape&#x27;</span>, <span class="number">58</span>, <span class="string">&#x27;male&#x27;</span>, [<span class="string">&#x27;Potions&#x27;</span>], <span class="string">&#x27;Dark arts&#x27;</span>, <span class="number">5</span>);</span><br><span class="line">snape.<span class="title function_">greeting</span>(); <span class="comment">// Hi! I&#x27;m Severus.</span></span><br><span class="line">snape.<span class="title function_">farewell</span>(); <span class="comment">// Severus has left the building. Bye for now.</span></span><br><span class="line">snape.<span class="property">age</span> <span class="comment">// 58</span></span><br><span class="line">snape.<span class="property">subject</span>; <span class="comment">// Dark arts</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="getter和setter"><a href="#getter和setter" class="headerlink" title="getter和setter"></a>getter和setter</h2><p>有时，我们可能想要更改我们创建的类中属性的值，或者我们不知道属性的最终值是什么。以 <code>Teacher</code> 举例，在我们创建它们之前，我们可能不知道老师会教什么科目，或者科目会随学期的变化而变化。</p>
<p>我们可以用 <code>getter</code> 和 <code>setter</code> 一起处理这种情况，它们往往成对工作：</p>
<ul>
<li><code>getter</code> 返回变量的当前值</li>
<li><code>setter</code> 将变量的值更改为它定义的值。</li>
</ul>
<p>修改后的 Teacher 类如下所示：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Teacher</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Person</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">first, last, age, gender, interests, subject, grade</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(first, last, age, gender, interests);</span><br><span class="line">    <span class="comment">// subject and grade are specific to Teacher</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_subject</span> = subject;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">grade</span> = grade;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">subject</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_subject</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">set</span> <span class="title function_">subject</span>(<span class="params">newSubject</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_subject</span> = newSubject;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在我们上面的类中，我们为 <code>subject</code> 属性设置了 getter 和 setter 。我们使用 <code>_</code>(下划线) 创建一个单独的值，用于存储相应地属性（如果不遵循此约定，则每次调用 get 或 set 时都会收到错误）：</p>
<ul>
<li>为了显示 <code>snape</code> 对象 <code>_subject</code> 属性的当前值，我们可以使用 getter 方法。<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Teacher</span>.<span class="property">subject</span></span><br></pre></td></tr></table></figure></li>
<li>为了给 <code>_subject</code> 属性分配新值，我们可以使用 setter 方法。<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Teacher</span>.<span class="property">subject</span>=<span class="string">&quot;new value&quot;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p><img src="/2021/03/18/JavaScript%E5%AF%B9%E8%B1%A1%E4%BB%8B%E7%BB%8D/9.png"></p>
<blockquote>
<p>setter 和 getter 实际上是为了检查和更新属性值而自定义的方法，不仅仅可以在 ES6 中使用。使用原型链形式编写的对象也可以定义它们。</p>
</blockquote>
<br>

<h2 id="何时在javascript中使用继承"><a href="#何时在javascript中使用继承" class="headerlink" title="何时在javascript中使用继承"></a>何时在javascript中使用继承</h2><p>JavaScript 的强大和灵活性来自于它的对象体系和继承方式。在某种程度上来说，你一直都在使用继承，无论是使用 WebAPI 的不同特性还是调用字符串、数组等浏览器内置对象的方法和属性的时候，你都在隐式地使用继承。</p>
<p>就在自己代码中使用继承而言，你可能不会使用的非常频繁，特别是在小型项目中或者刚开始学习时。但是随着您的代码量的增大，您会越来越发现它的必要性。如果您开始创建一系列拥有相似特性的对象时，那么创建一个包含所有共有功能的通用对象，然后在更特殊的对象类型中继承这些特性，将会变得更加方便有用。</p>
<blockquote>
<p>注: 考虑到 JavaScript 的工作方式，由于原型链等特性的存在，在不同对象之间功能的共享通常被叫做 <strong>委托</strong>（特殊的对象将功能委托给通用的对象类型完成）。这也许比将其称之为继承更为贴切，因为“被继承”了的功能并没有被拷贝到正在“进行继承”的对象中，相反它仍存在于通用的对象中。</p>
</blockquote>
<p>在使用继承时，建议不要使用过多层次的继承，并仔细追踪定义方法和属性的位置。过多的继承会在调试代码时给您带来无尽的混乱和痛苦，以至于你的代码会不应该的临时修改浏览器内置对象的原型。</p>
<p>总之，对象是另一种形式的代码重用，就像函数和循环一样，有他们特定的角色和优点。如果你发现自己创建了一堆相关的变量和函数，还想一起追踪它们并将其灵活打包的话，对象是个不错的主意。对象在你打算把一个数据集合从一个地方传递到另一个地方的时候非常有用。这些都可以在不使用构造器和继承的情况下完成。如果你只需要一个单一的对象实例，使用对象常量就很不错。</p>
<br>

<h1 id="使用json"><a href="#使用json" class="headerlink" title="使用json"></a>使用json</h1><p>JavaScript 对象表示法（JSON）是用于将<strong>结构化数据</strong>表示为 <strong>JavaScript 对象</strong>的标准格式，通常用于在网站上表示和传输数据（例如从服务器向客户端发送一些数据，因此可以将其显示在网页上）。</p>
<p>你会经常遇到它，所以在本文中，我将介绍如何使用 JavaScript 处理 JSON 的所有工作，包括访问 JSON 对象中的数据项并编写自己的JSON。</p>
<br>

<h2 id="什么是json"><a href="#什么是json" class="headerlink" title="什么是json"></a>什么是json</h2><p>JSON 是一种按照 JavaScript 对象语法的数据格式。虽然它是基于 JavaScript 语法，但它独立于 JavaScript，这也是为什么许多程序环境能够读取和生成 JSON。 </p>
<p>JSON 可以作为一个对象或者字符串存在，前者用于解读 JSON 中的数据，后者用于通过网络传输 JSON 数据。JavaScript 提供一个全局的可访问的 JSON 对象来对这两种数据进行转换。</p>
<p>一个 JSON 对象可以被储存在它自己的文件中，这基本上就是一个文本文件，扩展名为 .json，还有 MIME type 用于 application&#x2F;json。</p>
<h3 id="json对象"><a href="#json对象" class="headerlink" title="json对象"></a>json对象</h3><p>JSON 对象基于 JavaScript 对象，你可以把 JavaScript 对象原原本本的写入 JSON 数据——字符串、数字、数组、布尔还有其它的字面值对象。这允许您构造出一个对象树，如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;squadName&quot;</span> : <span class="string">&quot;Super hero squad&quot;</span>,</span><br><span class="line">  <span class="string">&quot;homeTown&quot;</span> : <span class="string">&quot;Metro City&quot;</span>,</span><br><span class="line">  <span class="string">&quot;formed&quot;</span> : <span class="number">2016</span>,</span><br><span class="line">  <span class="string">&quot;secretBase&quot;</span> : <span class="string">&quot;Super tower&quot;</span>,</span><br><span class="line">  <span class="string">&quot;active&quot;</span> : <span class="literal">true</span>,</span><br><span class="line">  <span class="string">&quot;members&quot;</span> : [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;name&quot;</span> : <span class="string">&quot;Molecule Man&quot;</span>,</span><br><span class="line">      <span class="string">&quot;age&quot;</span> : <span class="number">29</span>,</span><br><span class="line">      <span class="string">&quot;secretIdentity&quot;</span> : <span class="string">&quot;Dan Jukes&quot;</span>,</span><br><span class="line">      <span class="string">&quot;powers&quot;</span> : [</span><br><span class="line">        <span class="string">&quot;Radiation resistance&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Turning tiny&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Radiation blast&quot;</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;name&quot;</span> : <span class="string">&quot;Madame Uppercut&quot;</span>,</span><br><span class="line">      <span class="string">&quot;age&quot;</span> : <span class="number">39</span>,</span><br><span class="line">      <span class="string">&quot;secretIdentity&quot;</span> : <span class="string">&quot;Jane Wilson&quot;</span>,</span><br><span class="line">      <span class="string">&quot;powers&quot;</span> : [</span><br><span class="line">        <span class="string">&quot;Million tonne punch&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Damage resistance&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Superhuman reflexes&quot;</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;name&quot;</span> : <span class="string">&quot;Eternal Flame&quot;</span>,</span><br><span class="line">      <span class="string">&quot;age&quot;</span> : <span class="number">1000000</span>,</span><br><span class="line">      <span class="string">&quot;secretIdentity&quot;</span> : <span class="string">&quot;Unknown&quot;</span>,</span><br><span class="line">      <span class="string">&quot;powers&quot;</span> : [</span><br><span class="line">        <span class="string">&quot;Immortality&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Heat Immunity&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Inferno&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Teleportation&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Interdimensional travel&quot;</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果我们要加载对象进入 JavaScript 程序，以保存为一个名为 superHeroes 对象为例，我们使用 <code>.</code> 或 <code>[]</code> 访问对象内的数据：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">superHeroes.<span class="property">hometown</span></span><br><span class="line">superHeroes[<span class="string">&quot;active&quot;</span>]</span><br></pre></td></tr></table></figure>

<p>为了访问对象中的对象，您只需简单地链式访问（通过属性名和数组索引）。例如，访问 superHeroes 对象中的 members 数组对象的第二个元素的 powers 数组对象的第三个元素，您可以这样做：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">superHeroes[<span class="string">&quot;members&quot;</span>][<span class="number">1</span>][<span class="string">&quot;powers&quot;</span>][<span class="number">2</span>]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注：在 <a target="_blank" rel="noopener" href="https://a-pin.github.io/demo/json/JSONText.html">JSONText.html</a> 实例中，JSON 对象进入变量并且可访问。尝试加载它并且在您的浏览器上访问对象数据。</p>
</blockquote>
<br>

<h3 id="json数组"><a href="#json数组" class="headerlink" title="json数组"></a>json数组</h3><p>我们已经可以推测出 JSON 对象就是基于 JavaScript 对象，而且这几乎是正确的——我们说几乎正确的原因是<strong>数组对象</strong>也是一种合法的 JSON 对象，例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span> : <span class="string">&quot;Molecule Man&quot;</span>,</span><br><span class="line">    <span class="string">&quot;age&quot;</span> : <span class="number">29</span>,</span><br><span class="line">    <span class="string">&quot;secretIdentity&quot;</span> : <span class="string">&quot;Dan Jukes&quot;</span>,</span><br><span class="line">    <span class="string">&quot;powers&quot;</span> : [</span><br><span class="line">      <span class="string">&quot;Radiation resistance&quot;</span>,</span><br><span class="line">      <span class="string">&quot;Turning tiny&quot;</span>,</span><br><span class="line">      <span class="string">&quot;Radiation blast&quot;</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span> : <span class="string">&quot;Madame Uppercut&quot;</span>,</span><br><span class="line">    <span class="string">&quot;age&quot;</span> : <span class="number">39</span>,</span><br><span class="line">    <span class="string">&quot;secretIdentity&quot;</span> : <span class="string">&quot;Jane Wilson&quot;</span>,</span><br><span class="line">    <span class="string">&quot;powers&quot;</span> : [</span><br><span class="line">      <span class="string">&quot;Million tonne punch&quot;</span>,</span><br><span class="line">      <span class="string">&quot;Damage resistance&quot;</span>,</span><br><span class="line">      <span class="string">&quot;Superhuman reflexes&quot;</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>上面是完全合法的 JSON，你只需要通过数组索引就可以访问数组元素，如 <code>[0][&quot;powers&quot;][0]</code>。</p>
<h3 id="其他注意事项"><a href="#其他注意事项" class="headerlink" title="其他注意事项"></a>其他注意事项</h3><ul>
<li>JSON 是一种纯数据格式，它只包含属性，没有方法。</li>
<li>JSON 要求在<strong>字符串</strong>和<strong>属性名称</strong>周围使用双引号，单引号无效。</li>
<li>一个错位的逗号或分号就可以导致 JSON 文件出错。你可以通过像 <a target="_blank" rel="noopener" href="https://jsonlint.com/">JSONLint</a> 的应用程序来检验 JSON。</li>
<li>JSON 可以将任何标准合法的 JSON 数据格式化保存，不只是数组和对象。比如，一个单一的字符串或者数字可以是合法的 JSON 对象。虽然不是特别有用处。<br>与 JavaScript 代码中对象属性可以不加引号不同，JSON 中只有带引号的字符串可以用作属性。</li>
</ul>
<br>

<h2 id="一个json示例"><a href="#一个json示例" class="headerlink" title="一个json示例"></a>一个json示例</h2><br>

<h3 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h3><p>首先，拷贝 <a target="_blank" rel="noopener" href="https://github.com/a-pin/learning-area/blob/main/javascript/oojs/json/heroes.html">heroes.html</a> 和 <a target="_blank" rel="noopener" href="https://github.com/a-pin/learning-area/blob/main/javascript/oojs/json/style.css">style.css</a> 文件。前者包含了简单的 HTML，后者包含了简单的 CSS。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">header</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">section</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>添加 <code>&lt;script&gt;</code> 元素来包含我们的 JavaScript 代码。当前它只有两行，获得了 <code>&lt;header&gt;</code> 和 <code>&lt;section&gt;</code> 的引用，保存在变量中。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> header = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;header&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> section = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;section&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>我们要使用的 JSON 数据在<a target="_blank" rel="noopener" href="https://github.com/a-pin/learning-area/blob/main/javascript/oojs/json/superheroes.json">这里</a>。</p>
<p>我们准备把它加载到我们的页面中，然后使用漂亮的 DOM 操作来展示它，就像这样：</p>
<p><img src="/2021/03/18/JavaScript%E5%AF%B9%E8%B1%A1%E4%BB%8B%E7%BB%8D/10.png" alt="json-superheroes"></p>
<br>

<h3 id="加载json"><a href="#加载json" class="headerlink" title="加载json"></a>加载json</h3><p>为了载入 JSON 到页面中，我们将使用一个名为 <code>XMLHTTPRequest</code> 的 API（常称为XHR）。这是一个非常有用的 JavaScript 对象，使我们能够通过代码来向服务器请求资源文件（如：图片，文本，JSON，甚至HTML片段），意味着我们可以更新小段内容而不用重新加载整个页面。</p>
<ol>
<li>首先，我们将保存一个即将访问的 URL 作为变量。在您的 JavaScript 代码的底部添加下面的代码：  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> requestURL = <span class="string">&#x27;https://mdn.github.io/learning-area/javascript/oojs/json/superheroes.json&#x27;</span>;</span><br></pre></td></tr></table></figure></li>
<li>为了创建一个 HTTP 请求，我们需要创建一个 HTTP 请求对象，通过 new 构造函数的形式。在最下面的代码中写入：  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> request = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br></pre></td></tr></table></figure></li>
<li>现在我们需要使用 <code>open()</code> 函数打开一个新的请求，添加如下代码：  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.<span class="title function_">open</span>(<span class="string">&#x27;GET&#x27;</span>, requestURL);</span><br></pre></td></tr></table></figure>
  这个函数至少含有两个参数，其它的是可选参数。对于示例我们只需要两个强制参数</li>
</ol>
<ul>
<li>HTTP 方法，网络连接时使用。这个示例中 GET 就可以了，因为我们只要获得简单的数据。</li>
<li>URL，用于指向请求的地址。我们使用之前保存的变量。</li>
</ul>
<ol start="4">
<li>接下来，添加，两行代码，我们设定 <code>responseType</code> 为 JSON，所以服务器将知道我们想要返回一个 JSON 对象，然后发送请求：  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">request.<span class="property">responseType</span> = <span class="string">&#x27;json&#x27;</span>;</span><br><span class="line">request.<span class="title function_">send</span>();</span><br></pre></td></tr></table></figure></li>
<li>最后一点内容涉及相应来自服务器的返回数据，然后处理它，添加如下代码在您先前的代码下方：  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">request.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> superHeroes = request.<span class="property">response</span>;</span><br><span class="line">  <span class="title function_">populateHeader</span>(superHeroes);</span><br><span class="line">  <span class="title function_">showHeroes</span>(superHeroes);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
这儿我们保存了相应我们请求的数据(访问 <code>response</code> 属性) 于变量 <code>superHeroes</code>；这个变量现在含有 JSON！我们现在把 <code>superHeroes</code> 传给两个函数，第一个函数将会用正确的数据填充 <code>&lt;header&gt;</code>，同时第二个函数将创建一个信息卡片，然后把它插入 <code>&lt;section&gt;</code> 中。</li>
</ol>
<p>我们把代码包在事件处理函数中，当请求对象 load 事件触发时执行代码，这是因为请求对象 load 事件只有在请求成功时触发；这种方式可以保证事件触发时 <code>request.response</code> 是绝对可以访问的。</p>
<h3 id="定位header"><a href="#定位header" class="headerlink" title="定位header"></a>定位header</h3><p>现在我们已经获得我们的 JSON 数据，让我们利用它来写两个我们使用的函数。首先，添加下面的代码于之前的代码下方：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">populateHeader</span>(<span class="params">jsonObj</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> myH1 = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;h1&#x27;</span>);</span><br><span class="line">  myH1.<span class="property">textContent</span> = jsonObj[<span class="string">&#x27;squadName&#x27;</span>];</span><br><span class="line">  header.<span class="title function_">appendChild</span>(myH1);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> myPara = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;p&#x27;</span>);</span><br><span class="line">  myPara.<span class="property">textContent</span> = <span class="string">&#x27;Hometown: &#x27;</span> + jsonObj[<span class="string">&#x27;homeTown&#x27;</span>] + <span class="string">&#x27; // Formed: &#x27;</span> + jsonObj[<span class="string">&#x27;formed&#x27;</span>];</span><br><span class="line">  header.<span class="title function_">appendChild</span>(myPara);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们称参数为 <code>jsonObj</code>，那也是为什么我们要在其中调用 JSON 对象。这儿我们首先使用 <code>createElement()</code> 创建了一个 <code>&lt;h1&gt;</code> 节点，将它的 <code>textContent</code> 设为 JSON 对象的 <code>squadName</code> 属性，然后通过 <code>appendChild()</code> 把它加入 <code>&lt;header&gt;</code> 中。然后我们对段落做了相同的一件事情：创建，设置内容，追加到 <code>&lt;header&gt;</code>。唯一的不同在于它的内容设为一个与 JSON 内属性 <code>homeTown</code> 和 <code>formed</code> 相关联的字符串。</p>
<h3 id="创建英雄信息卡片"><a href="#创建英雄信息卡片" class="headerlink" title="创建英雄信息卡片"></a>创建英雄信息卡片</h3><p>接下来，添加如下的函数到脚本代码底部，这个函数创建和展示了superhero cards：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">showHeroes</span>(<span class="params">jsonObj</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> heroes = jsonObj[<span class="string">&#x27;members&#x27;</span>];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; heroes.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">var</span> myArticle = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;article&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> myH2 = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;h2&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> myPara1 = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;p&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> myPara2 = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;p&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> myPara3 = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;p&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> myList = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;ul&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    myH2.<span class="property">textContent</span> = heroes[i].<span class="property">name</span>;</span><br><span class="line">    myPara1.<span class="property">textContent</span> = <span class="string">&#x27;Secret identity: &#x27;</span> + heroes[i].<span class="property">secretIdentity</span>;</span><br><span class="line">    myPara2.<span class="property">textContent</span> = <span class="string">&#x27;Age: &#x27;</span> + heroes[i].<span class="property">age</span>;</span><br><span class="line">    myPara3.<span class="property">textContent</span> = <span class="string">&#x27;Superpowers:&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> superPowers = heroes[i].<span class="property">powers</span>;</span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; superPowers.<span class="property">length</span>; j++) &#123;</span><br><span class="line">      <span class="keyword">var</span> listItem = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;li&#x27;</span>);</span><br><span class="line">      listItem.<span class="property">textContent</span> = superPowers[j];</span><br><span class="line">      myList.<span class="title function_">appendChild</span>(listItem);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    myArticle.<span class="title function_">appendChild</span>(myH2);</span><br><span class="line">    myArticle.<span class="title function_">appendChild</span>(myPara1);</span><br><span class="line">    myArticle.<span class="title function_">appendChild</span>(myPara2);</span><br><span class="line">    myArticle.<span class="title function_">appendChild</span>(myPara3);</span><br><span class="line">    myArticle.<span class="title function_">appendChild</span>(myList);</span><br><span class="line"></span><br><span class="line">    section.<span class="title function_">appendChild</span>(myArticle);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>首先，我们保存了 JSON 的 <code>members</code> 属性作为一个变量。这个数组含有多个带有英雄信息的对象。</p>
<p>接下来，我们使用一个循环来，遍历每个元素。对于每一个元素，我们：</p>
<ol>
<li>创建几个元素： 一个 <code>&lt;article&gt;</code>，一个 <code>&lt;h2&gt;</code>，三个 <code>&lt;p&gt;</code> 和一个 <code>&lt;ul&gt;</code>。</li>
<li>设置 <code>&lt;h2&gt;</code> 为当前英雄的 <code>name</code>。</li>
<li>使用他们的 <code>secretIdentity</code>,<code>age</code>,<code>&quot;Superpowers:&quot;</code> 介绍信息列表填充三个段落。</li>
<li>保存 <code>powers</code> 属性于另一个变量 <code>superPowers</code>，包含英雄的 <code>superpowers</code> 列表。</li>
<li>使用另一个循环来遍历当前的英雄的 <code>superpowers</code>，对于每一个元素我们创建 <code>&lt;li&gt;</code> 元素，把 <code>superpower</code> 放进去，然后使用 <code>appendChild()</code> 把 <code>listItem</code> 放入 <code>&lt;ul&gt;</code> 元素中。</li>
<li>最后一件事情是追加 <code>&lt;h2&gt;</code>，<code>&lt;p&gt;</code>还有 <code>&lt;ul&gt;</code> 进入 <code>&lt;article&gt;</code> (<code>myArticle</code>)。然后将 <code>&lt;article&gt;</code> 追加到 <code>&lt;section&gt;</code>。追加的顺序很重要，因为他们将被展示在 HTML 中。</li>
</ol>
<blockquote>
<p>注：如有疑难,试试引用我们的 <a target="_blank" rel="noopener" href="https://github.com/a-pin/learning-area/blob/main/javascript/oojs/json/heroes-finished.html">heroes-finished.html</a> 代码。</p>
</blockquote>
<br>

<h2 id="对象和文本间的转换"><a href="#对象和文本间的转换" class="headerlink" title="对象和文本间的转换"></a>对象和文本间的转换</h2><p>上述示例就访问 JSON 而言是简单的，因为我们设置了 XHR 来访问 JSON 格式数据：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.<span class="property">responseType</span> = <span class="string">&#x27;json&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>但是有时候我们没有那么幸运，我们接收到一些字符串作为 JSON 数据，然后我们想要将它转换为对象。当我们想要发送 JSON 数据作为信息，我们将需要转换它为字符串，我们经常需要正确的转换数据，这两个问题在 web 环境中很普遍以至于浏览器拥有一个内建的 JSON，包含以下两个方法：</p>
<ul>
<li><code>parse()</code>：以文本字符串形式接受JSON对象作为参数，并返回相应的对象。</li>
<li><code>stringify()</code>：接收一个对象作为参数，返回一个对应的JSON字符串。</li>
</ul>
<p>你可以看看我们 <a target="_blank" rel="noopener" href="https://github.com/a-pin/learning-area/blob/main/javascript/oojs/json/heroes-finished-json-parse.html">heroes-finished-json-parse.html</a> 示例的第一个操作，除了返回的是 text，这做了一件与我们之前一模一样的事情，然后使用 <code>parse()</code> 来将他转换成为 JavaScript 对象。关键片段如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">request.<span class="title function_">open</span>(<span class="string">&#x27;GET&#x27;</span>, requestURL);</span><br><span class="line">request.<span class="property">responseType</span> = <span class="string">&#x27;text&#x27;</span>; <span class="comment">// now we&#x27;re getting a string!</span></span><br><span class="line">request.<span class="title function_">send</span>();</span><br><span class="line"></span><br><span class="line">request.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> superHeroesText = request.<span class="property">response</span>; <span class="comment">// get the string from the response</span></span><br><span class="line">  <span class="keyword">var</span> superHeroes = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(superHeroesText); <span class="comment">// convert it to an object</span></span><br><span class="line">  <span class="title function_">populateHeader</span>(superHeroes);</span><br><span class="line">  <span class="title function_">showHeroes</span>(superHeroes);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>正如您所想，<code>stringify()</code> 做相反的事情. 尝试将下面的代码输入您的浏览器 JS 控制台：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myJSON = &#123; <span class="string">&quot;name&quot;</span> : <span class="string">&quot;Chris&quot;</span>, <span class="string">&quot;age&quot;</span> : <span class="string">&quot;38&quot;</span> &#125;;</span><br><span class="line">myJSON</span><br><span class="line"><span class="keyword">var</span> myString = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(myJSON);</span><br><span class="line">myString</span><br></pre></td></tr></table></figure>

<p>这儿我们创建了一个 JavaScript 对象，然后检查了它包含了什么，然后用 <code>stringify()</code> 将它转换成 JSON 字符串，最后保存返回值作为变量，然后再一次检查。</p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/web前端/">web前端</a>, <a href="/categories/web前端/mdn/">mdn</a>, <a href="/categories/web前端/mdn/JavaScript/">JavaScript</a>
    </span>
    

    

    </div>

    
  </div>
</article>

  






    </main>

    <footer class="site-footer">
  <p class="site-info">
    Deployed by <a href="https://github.com/kaedea/notion-down" target="_blank">notion-down</a> and
    Theme by <a href="https://github.com/kaedea/hexo-theme-hacker" target="_blank">hexo-theme-hacker</a>
    </br>
    
    &copy; 2022 a-pin
    
  </p>
</footer>
    
  </div>
</div>
</body>
</html>